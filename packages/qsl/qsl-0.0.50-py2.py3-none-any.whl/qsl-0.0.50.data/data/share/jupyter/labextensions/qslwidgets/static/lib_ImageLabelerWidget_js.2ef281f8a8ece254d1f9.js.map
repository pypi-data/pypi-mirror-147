{"version":3,"file":"lib_ImageLabelerWidget_js.2ef281f8a8ece254d1f9.js","mappings":";;;;;;;;;AAAa;AACb;AACA,6CAA6C;AAC7C;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,wBAAwB,GAAG,yBAAyB;AACpD,gCAAgC,mBAAO,CAAC,oDAAO;AAC/C,oCAAoC,mBAAO,CAAC,4DAAW;AACvD,oBAAoB,mBAAO,CAAC,oFAAuB;AACnD,eAAe,mBAAO,CAAC,oFAAuB;AAC9C,8BAA8B,mBAAO,CAAC,oGAAqB;AAC3D,gBAAgB,mBAAO,CAAC,+BAAS;AACjC,iBAAiB,mBAAO,CAAC,6DAAQ;AACjC,kBAAkB,mBAAO,CAAC,mCAAW;AACrC;AACA;AACA;AACA;AACA;AACA,cAAc,wBAAwB;AACtC,cAAc,SAAS,sCAAsC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,kBAAkB,OAAO;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,2EAA2E;AAC3E;AACA;AACA,SAAS,4BAA4B,6KAA6K,YAAY,2BAA2B,6DAA6D,4BAA4B,yFAAyF,YAAY;AACvb;AACA,6EAA6E,4BAA4B,+FAA+F,YAAY,2BAA2B,yHAAyH;AACxW;AACA;AACA;AACA,2DAA2D,uBAAuB,4SAA4S;AAC9X;AACA;AACA,yBAAyB;AACzB,gDAAgD;AAChD;AACA;AACA;AACA,kDAAkD;AAClD,uDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,wBAAwB;AACxB;;;;;;;;;;AChIa;AACb;AACA,6CAA6C;AAC7C;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,qBAAqB,GAAG,qBAAqB,GAAG,8BAA8B;AAC9E,gCAAgC,mBAAO,CAAC,oDAAO;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,KAAK;AACxC;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,qBAAqB;AACrB;;;;;;;;;;AC5Ca;AACb;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,mBAAmB,GAAG,sBAAsB;AAC5C;AACA;AACA;AACA,aAAa,mBAAO,CAAC,uCAAiB;AACtC,sBAAsB;AACtB,mBAAmB;AACnB","sources":["webpack://qslwidgets/./lib/ImageLabelerWidget.js","webpack://qslwidgets/./lib/hooks.js","webpack://qslwidgets/./lib/version.js"],"sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ImageLabelerView = exports.ImageLabelerModel = void 0;\nconst react_1 = __importDefault(require(\"react\"));\nconst react_dom_1 = __importDefault(require(\"react-dom\"));\nconst coreutils_1 = require(\"@jupyterlab/coreutils\");\nconst base_1 = require(\"@jupyter-widgets/base\");\nconst react_image_labeler_1 = require(\"react-image-labeler\");\nconst hooks_1 = require(\"./hooks\");\nconst lodash_1 = require(\"lodash\");\nconst version_1 = require(\"./version\");\nconst DEFAULT_PROPERTIES = {\n    states: [],\n    urls: [],\n    type: \"image\",\n    transitioning: false,\n    config: { image: [], regions: [] },\n    labels: { image: {}, polygons: [], masks: [], boxes: [] },\n    updated: Date.now(),\n    action: \"\",\n    preload: [],\n    showNavigation: true,\n    maxCanvasSize: 512,\n    buttons: {\n        next: true,\n        prev: true,\n        save: true,\n        config: true,\n        delete: true,\n        ignore: true,\n        unignore: true,\n    },\n    base: {\n        serverRoot: \"\",\n        url: \"\",\n    },\n    progress: -1,\n    mode: \"light\",\n};\nconst Widget = ({ model }) => {\n    const extract = hooks_1.useModelStateExtractor(model);\n    const config = extract(\"config\");\n    const states = extract(\"states\");\n    const transitioning = extract(\"transitioning\");\n    const urls = extract(\"urls\");\n    const type = extract(\"type\");\n    const labels = extract(\"labels\");\n    const updated = extract(\"updated\");\n    const action = extract(\"action\");\n    const base = extract(\"base\");\n    const progress = extract(\"progress\");\n    const mode = extract(\"mode\");\n    const buttons = extract(\"buttons\");\n    const preload = extract(\"preload\");\n    const maxCanvasSize = extract(\"maxCanvasSize\");\n    const showNavigation = extract(\"showNavigation\");\n    const id = react_1.default.useMemo(() => lodash_1.uniqueId(\"qslwidgetid\"), []);\n    react_1.default.useEffect(() => {\n        base.set({\n            serverRoot: coreutils_1.PageConfig.getOption(\"serverRoot\"),\n            url: coreutils_1.PageConfig.getBaseUrl(),\n        });\n    });\n    const common = {\n        config: {\n            image: config.value.image || [],\n            regions: config.value.regions || [],\n        },\n        preload: preload.value,\n        options: {\n            progress: progress.value,\n            maxCanvasSize: maxCanvasSize.value,\n            showNavigation: showNavigation.value,\n        },\n        callbacks: {\n            onSave: buttons.value[\"save\"]\n                ? (newLabels) => {\n                    labels.set(newLabels);\n                    updated.set(Date.now());\n                }\n                : undefined,\n            onSaveConfig: buttons.value[\"config\"] ? config.set : undefined,\n            onNext: buttons.value[\"next\"] ? () => action.set(\"next\") : undefined,\n            onPrev: buttons.value[\"prev\"] ? () => action.set(\"prev\") : undefined,\n            onDelete: buttons.value[\"delete\"]\n                ? () => action.set(\"delete\")\n                : undefined,\n            onIgnore: buttons.value[\"ignore\"]\n                ? () => action.set(\"ignore\")\n                : undefined,\n            onUnignore: buttons.value[\"unignore\"]\n                ? () => action.set(\"unignore\")\n                : undefined,\n        },\n    };\n    return (react_1.default.createElement(react_image_labeler_1.Labeler, { style: {\n            padding: 16,\n            backgroundColor: mode.value == \"dark\" ? \"rgb(18, 18, 18)\" : \"white\",\n        }, mode: mode.value, id: id }, states.value.length === 0 ? null : states.value.length == 1 ? (type.value === \"image\" ? (react_1.default.createElement(react_image_labeler_1.ImageLabeler, Object.assign({}, common, { labels: (labels.value || {}), target: urls.value[0], metadata: transitioning.value ? {} : states.value[0].metadata }))) : (react_1.default.createElement(react_image_labeler_1.VideoLabeler, Object.assign({}, common, { labels: (Array.isArray(labels.value)\n            ? labels.value\n            : []), target: urls.value[0], metadata: transitioning.value ? {} : states.value[0].metadata })))) : (react_1.default.createElement(react_image_labeler_1.BatchImageLabeler, Object.assign({}, common, { labels: (labels.value || {}), target: urls.value, states: transitioning.value ? [] : states.value, setStates: (newStates) => states.set(newStates) })))));\n};\nclass ImageLabelerModel extends base_1.DOMWidgetModel {\n    defaults() {\n        return Object.assign(Object.assign(Object.assign({}, super.defaults()), { _model_name: ImageLabelerModel.model_name, _model_module: ImageLabelerModel.model_module, _model_module_version: ImageLabelerModel.model_module_version, _view_name: ImageLabelerModel.view_name, _view_module: ImageLabelerModel.view_module, _view_module_version: ImageLabelerModel.view_module_version }), DEFAULT_PROPERTIES);\n    }\n}\nexports.ImageLabelerModel = ImageLabelerModel;\nImageLabelerModel.serializers = Object.assign({}, base_1.DOMWidgetModel.serializers);\nImageLabelerModel.model_name = \"ImageLabelerModel\";\nImageLabelerModel.model_module = version_1.MODULE_NAME;\nImageLabelerModel.model_module_version = version_1.MODULE_VERSION;\nImageLabelerModel.view_name = \"ImageLabelerView\"; // Set to null if no view\nImageLabelerModel.view_module = version_1.MODULE_NAME; // Set to null if no view\nImageLabelerModel.view_module_version = version_1.MODULE_VERSION;\nclass ImageLabelerView extends base_1.DOMWidgetView {\n    render() {\n        this.el.classList.add(\"qsl-image-labeler-widget\");\n        const component = react_1.default.createElement(Widget, {\n            model: this.model,\n        });\n        react_dom_1.default.render(component, this.el);\n    }\n}\nexports.ImageLabelerView = ImageLabelerView;\n//# sourceMappingURL=ImageLabelerWidget.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useModelEvent = exports.useModelState = exports.useModelStateExtractor = void 0;\nconst react_1 = __importDefault(require(\"react\"));\n/**\n *\n * @param name property name in the Python model object.\n * @returns model state and set state function.\n */\nconst useModelState = (name, model) => {\n    const [value, setState] = react_1.default.useState(model === null || model === void 0 ? void 0 : model.get(name));\n    useModelEvent(model, `change:${name}`, (model) => {\n        setState(model.get(name));\n    }, [name]);\n    function set(val, options) {\n        model === null || model === void 0 ? void 0 : model.set(name, val, options);\n        model === null || model === void 0 ? void 0 : model.save_changes();\n    }\n    return { value, set };\n};\nexports.useModelState = useModelState;\nconst useModelStateExtractor = (model) => {\n    return (name) => {\n        return useModelState(name, model);\n    };\n};\nexports.useModelStateExtractor = useModelStateExtractor;\n/**\n * Subscribes a listener to the model event loop.\n * @param event String identifier of the event that will trigger the callback.\n * @param callback Action to perform when event happens.\n * @param deps Dependencies that should be kept up to date within the callback.\n */\nconst useModelEvent = (model, event, callback, deps) => {\n    react_1.default.useEffect(() => {\n        const callbackWrapper = (e) => model && callback(model, e);\n        model === null || model === void 0 ? void 0 : model.on(event, callbackWrapper);\n        return () => void (model === null || model === void 0 ? void 0 : model.unbind(event, callbackWrapper));\n    }, (deps || []).concat([model]));\n};\nexports.useModelEvent = useModelEvent;\n//# sourceMappingURL=hooks.js.map","\"use strict\";\n// Copyright (c) Fausto Morales\n// Distributed under the terms of the MIT License.\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MODULE_NAME = exports.MODULE_VERSION = void 0;\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nconst data = require(\"../package.json\");\nexports.MODULE_VERSION = data.version;\nexports.MODULE_NAME = data.name;\n//# sourceMappingURL=version.js.map"],"names":[],"sourceRoot":""}