"use strict";(self["webpackChunkunmanic_frontend"]=self["webpackChunkunmanic_frontend"]||[]).push([[312],{7312:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Pe});var s=n(3673),i=n(2323),l=n(1561),a=n.n(l);const o={class:"q-pa-none"},d={class:"row"},r={class:"col q-ma-sm"},u={class:"q-pa-md",style:{"max-width":"500px"}},c={class:"q-mb-none"},m={class:"q-gutter-sm"},g={class:"q-mb-none"},p={class:"q-gutter-sm"},h={class:"row"},k={class:"col-3"},w={class:"text-weight-bold"},b={class:"col-grow"},_={class:"q-pl-none"},f={class:"row"},v={class:"col-3"},q={class:"text-weight-bold"},y={class:"col-grow"},I={class:"q-pl-none"},W={class:"text-grey-8 q-gutter-xs"},$={class:"text-h6"},T={key:0},C={class:"row"},Q={class:"col-6 text-center"};function S(e,t,n,l,S,Z){const x=(0,s.up)("q-skeleton"),R=(0,s.up)("q-input"),z=(0,s.up)("q-separator"),V=(0,s.up)("q-img"),H=(0,s.up)("q-item-section"),D=(0,s.up)("q-item-label"),j=(0,s.up)("q-tooltip"),U=(0,s.up)("q-btn"),P=(0,s.up)("q-item"),A=(0,s.up)("q-list"),L=(0,s.up)("q-space"),N=(0,s.up)("q-bar"),B=(0,s.up)("q-card-section"),J=(0,s.up)("q-card-actions"),O=(0,s.up)("q-card"),F=(0,s.up)("q-dialog"),K=(0,s.up)("q-form"),Y=(0,s.up)("q-page"),E=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(Y,{padding:""},{default:(0,s.w5)((()=>[(0,s._)("div",o,[(0,s._)("div",d,[(0,s._)("div",r,[(0,s._)("div",u,[(0,s.Wm)(K,{onSubmit:Z.save,class:"q-gutter-md"},{default:(0,s.w5)((()=>[(0,s._)("h5",c,(0,i.zw)(e.$t("components.settings.link.thisInstallation")),1),(0,s._)("div",m,[null===S.installationName?((0,s.wg)(),(0,s.j4)(x,{key:0,type:"QInput"})):(0,s.kq)("",!0),null!==S.installationName?((0,s.wg)(),(0,s.j4)(R,{key:1,outlined:"",color:"primary",modelValue:S.installationName,"onUpdate:modelValue":t[0]||(t[0]=e=>S.installationName=e),label:e.$t("components.settings.link.nameThisInstall"),placeholder:S.installationName},null,8,["modelValue","label","placeholder"])):(0,s.kq)("",!0)]),(0,s.Wm)(z,{class:"q-my-lg"}),(0,s._)("h5",g,(0,i.zw)(e.$t("components.settings.link.remoteInstallations")),1),(0,s._)("div",p,[null===S.remoteInstallations?((0,s.wg)(),(0,s.j4)(x,{key:0,type:"text"})):(0,s.kq)("",!0),(0,s.Wm)(A,{bordered:"",separator:"",class:"rounded-borders"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(S.remoteInstallations,((t,n)=>((0,s.wg)(),(0,s.j4)(P,{key:n},{default:(0,s.w5)((()=>[(0,s.Wm)(H,{avatar:""},{default:(0,s.w5)((()=>[t.available?((0,s.wg)(),(0,s.j4)(V,{key:0,src:a()})):((0,s.wg)(),(0,s.j4)(V,{key:1,"img-style":{filter:"grayscale(100%)"},src:a()},null,8,["img-style"]))])),_:2},1024),(0,s.Wm)(z,{inset:"",vertical:"",class:"q-mr-sm"}),(0,s.Wm)(H,{class:"q-px-sm q-mx-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(D,{lines:"1"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(t.address),1)])),_:2},1024),(0,s.Wm)(D,{caption:"",lines:"2"},{default:(0,s.w5)((()=>[(0,s._)("div",h,[(0,s._)("div",k,[(0,s._)("span",w,(0,i.zw)(e.$t("components.settings.link.name"))+":",1)]),(0,s._)("div",b,[(0,s._)("span",_,(0,i.zw)(t.name),1)])])])),_:2},1024),(0,s.Wm)(D,{caption:"",lines:"2"},{default:(0,s.w5)((()=>[(0,s._)("div",f,[(0,s._)("div",v,[(0,s._)("span",q,(0,i.zw)(e.$t("components.settings.link.version"))+":",1)]),(0,s._)("div",y,[(0,s._)("span",I,(0,i.zw)(t.version),1)])])])),_:2},1024)])),_:2},1024),(0,s.Wm)(z,{inset:"",vertical:"",class:"q-mx-sm"}),(0,s.Wm)(H,{center:"",side:""},{default:(0,s.w5)((()=>[(0,s._)("div",W,[(0,s.Wm)(U,{size:"12px",flat:"",dense:"",round:"",icon:"tune",onClick:e=>Z.configureRemoteInstallation(n)},{default:(0,s.w5)((()=>[(0,s.Wm)(j,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("tooltips.configure")),1)])),_:1})])),_:2},1032,["onClick"]),(0,s.Wm)(U,{flat:"",dense:"",round:"",size:"12px",color:"negative",icon:"delete",onClick:e=>Z.deleteRemoteInstallation(n)},{default:(0,s.w5)((()=>[(0,s.Wm)(j,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("tooltips.delete")),1)])),_:1})])),_:2},1032,["onClick"])])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,s.Wm)(N,{class:"bg-transparent"},{default:(0,s.w5)((()=>[(0,s.Wm)(L),(0,s.Wm)(U,{round:"",flat:"",color:"primary",icon:"add",onClick:t[1]||(t[1]=e=>S.newRemoteInstallation=!0)},{default:(0,s.w5)((()=>[(0,s.Wm)(j,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("tooltips.add")),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(F,{modelValue:S.newRemoteInstallation,"onUpdate:modelValue":t[3]||(t[3]=e=>S.newRemoteInstallation=e),persistent:""},{default:(0,s.w5)((()=>[(0,s.Wm)(O,{style:{"min-width":"350px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(B,null,{default:(0,s.w5)((()=>[(0,s._)("div",$,(0,i.zw)(e.$t("components.settings.link.addRemoteInstallation")),1)])),_:1}),(0,s.Wm)(B,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s.Wm)(R,{outlined:"",color:"primary",modelValue:S.newRemoteInstallationAddress,"onUpdate:modelValue":t[2]||(t[2]=e=>S.newRemoteInstallationAddress=e),label:e.$t("components.settings.link.address"),placeholder:"192.168.1.2:8888"},null,8,["modelValue","label"])])),_:1}),(0,s.Wm)(J,{align:"right",class:"text-primary"},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(U,{flat:"",label:e.$t("navigation.cancel")},null,8,["label"]),[[E]]),(0,s.wy)((0,s.Wm)(U,{onClick:Z.addNewRemoteInstallation,flat:"",label:e.$t("components.settings.link.add")},null,8,["onClick","label"]),[[E]])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,s._)("div",null,[(0,s.Wm)(U,{label:e.$t("navigation.submit"),type:"submit",color:"secondary"},null,8,["label"])])])),_:1},8,["onSubmit"])])])]),e.$q.platform.is.mobile?((0,s.wg)(),(0,s.iD)("div",T,[(0,s.Wm)(z,{class:"q-mb-lg"}),(0,s._)("div",C,[(0,s._)("div",Q,[(0,s.Wm)(O,{flat:"",bordered:"",onClick:t[4]||(t[4]=t=>e.$router.push("/ui/settings-plugins")),class:"q-ma-xs"},{default:(0,s.w5)((()=>[(0,s.Wm)(U,{icon:"navigate_before",flat:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("navigation.plugins")),1)])),_:1})])),_:1})])])])):(0,s.kq)("",!0)])])),_:1})}var Z=n(4190),x=n(1959),R=n(8825),z=n(5948);const V={class:"row items-center no-wrap"},H={class:"col"},D={class:"text-h6 text-blue-10"},j={class:"col-auto"},U={class:"q-pa-md"},P={class:"row"},A={class:"col-4 text-h6"},L={class:"col-4"},N={class:"row"},B={class:"col-4 text-h6"},J={class:"col-4"},O={class:"row"},F={class:"col-4 text-h6"},K={class:"col-4"},Y={class:""},E={class:"q-gutter-sm"},G={class:""},M={class:"q-gutter-sm"},X={class:"q-gutter-sm"},ee={key:0,class:"sub-setting"},te={class:"q-gutter-sm"},ne={class:"q-gutter-sm"},se={key:1,class:"sub-setting"},ie={class:"q-gutter-sm"},le={class:"q-pl-lg",style:{width:"80%"}};function ae(e,t,n,l,a,o){const d=(0,s.up)("q-tooltip"),r=(0,s.up)("q-btn"),u=(0,s.up)("q-card-section"),c=(0,s.up)("q-separator"),m=(0,s.up)("q-input"),g=(0,s.up)("q-skeleton"),p=(0,s.up)("q-toggle"),h=(0,s.up)("q-slider"),k=(0,s.up)("q-card"),w=(0,s.up)("q-dialog"),b=(0,s.Q2)("close-popup"),_=(0,s.Q2)("touch-swipe");return(0,s.wg)(),(0,s.j4)(w,{ref:"linkConfigureDialogRef",maximized:e.$q.platform.is.mobile,"transition-show":"slide-left","transition-hide":"slide-right","full-height":"",position:"right",onBeforeHide:o.saveInstallationLinkConfig,onHide:o.onDialogHide},{default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.j4)(k,{style:{width:"700px","max-width":"90vw"}},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s._)("div",V,[(0,s._)("div",H,[(0,s._)("div",D,(0,i.zw)(n.dialogHeader),1)]),(0,s._)("div",j,[(0,s.wy)(((0,s.wg)(),(0,s.j4)(r,{color:"grey-7",dense:"",round:"",flat:"",icon:"arrow_forward"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("tooltips.close")),1)])),_:1})])),_:1})),[[b]])])])])),_:1}),(0,s.Wm)(u,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s._)("div",U,[(0,s.Wm)(k,{flat:""},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s._)("div",P,[(0,s._)("div",A,(0,i.zw)(e.$t("components.settings.link.name"))+":",1),(0,s._)("div",L,(0,i.zw)(e.name),1)]),(0,s._)("div",N,[(0,s._)("div",B,(0,i.zw)(e.$t("components.settings.link.address"))+":",1),(0,s._)("div",J,(0,i.zw)(e.address),1)]),(0,s._)("div",O,[(0,s._)("div",F,(0,i.zw)(e.$t("components.settings.link.version"))+":",1),(0,s._)("div",K,(0,i.zw)(e.version),1)])])),_:1}),(0,s.Wm)(c),(0,s.Wm)(u,{class:"q-pa-none"},{default:(0,s.w5)((()=>[(0,s._)("h5",Y,(0,i.zw)(e.$t("components.settings.link.connection")),1),(0,s._)("div",E,[(0,s.Wm)(m,{outlined:"",color:"primary",modelValue:e.address,"onUpdate:modelValue":t[0]||(t[0]=t=>e.address=t),label:e.$t("components.settings.link.address"),placeholder:e.address},null,8,["modelValue","label","placeholder"])]),(0,s._)("h5",G,(0,i.zw)(e.$t("components.settings.link.configuration")),1),(0,s._)("div",M,[null===e.enableReceivingTasks?((0,s.wg)(),(0,s.j4)(g,{key:0,type:"QToggle"})):((0,s.wg)(),(0,s.j4)(p,{key:1,modelValue:e.enableReceivingTasks,"onUpdate:modelValue":t[1]||(t[1]=t=>e.enableReceivingTasks=t),label:e.$t("components.settings.link.allowReceivingTasks")},null,8,["modelValue","label"]))]),(0,s._)("div",X,[null===e.enableSendingTasks?((0,s.wg)(),(0,s.j4)(g,{key:0,type:"QToggle"})):((0,s.wg)(),(0,s.j4)(p,{key:1,modelValue:e.enableSendingTasks,"onUpdate:modelValue":t[2]||(t[2]=t=>e.enableSendingTasks=t),label:e.$t("components.settings.link.allowSendingTasks"),disable:"???"===e.address},null,8,["modelValue","label","disable"]))]),e.enableSendingTasks?((0,s.wg)(),(0,s.iD)("div",ee,[(0,s._)("div",te,[null===e.enableTaskPreloading?((0,s.wg)(),(0,s.j4)(g,{key:0,type:"QToggle"})):((0,s.wg)(),(0,s.j4)(p,{key:1,modelValue:e.enableTaskPreloading,"onUpdate:modelValue":t[3]||(t[3]=t=>e.enableTaskPreloading=t),label:e.$t("components.settings.link.enableTaskPreloading")},null,8,["modelValue","label"]))])])):(0,s.kq)("",!0),(0,s._)("div",ne,[null===e.enableDistributedWorkerCount?((0,s.wg)(),(0,s.j4)(g,{key:0,type:"QToggle"})):((0,s.wg)(),(0,s.j4)(p,{key:1,modelValue:e.enableDistributedWorkerCount,"onUpdate:modelValue":t[4]||(t[4]=t=>e.enableDistributedWorkerCount=t),label:e.$t("components.settings.link.enableDistributedWorkerCount")},null,8,["modelValue","label"]))]),e.enableDistributedWorkerCount?((0,s.wg)(),(0,s.iD)("div",se,[(0,s._)("div",ie,[null===e.distributedWorkerCountTarget?((0,s.wg)(),(0,s.j4)(g,{key:0,type:"QSlider"})):(0,s.kq)("",!0),(0,s._)("div",le,[null!==e.distributedWorkerCountTarget?((0,s.wg)(),(0,s.j4)(h,{key:0,modelValue:e.distributedWorkerCountTarget,"onUpdate:modelValue":t[5]||(t[5]=t=>e.distributedWorkerCountTarget=t),min:0,max:12,label:"","label-value":e.$t("components.settings.link.workerTarget")+": "+e.distributedWorkerCountTarget,"label-always":"",color:"primary"},null,8,["modelValue","label-value"])):(0,s.kq)("",!0)])])])):(0,s.kq)("",!0)])),_:1})])),_:1})])])),_:1})])),_:1})),[[_,o.hide,void 0,{touch:!0,right:!0}]])])),_:1},8,["maximized","onBeforeHide","onHide"])}var oe=n(52),de=n.n(oe),re=n(7689);const ue={name:"LinkConfigureDialog",props:{dialogHeader:{type:String,default:" --- header --- "},uuid:{type:String,default:" - "}},emits:["ok","hide","path"],methods:{show(){this.$refs.linkConfigureDialogRef.show(),this.fetchInstallationLinkConfig(this.uuid)},hide(){this.$refs.linkConfigureDialogRef.hide()},onDialogHide(){this.$emit("ok",{}),this.$emit("hide")},fetchInstallationLinkConfig:function(e){this.currentUuid=e;let t={uuid:this.currentUuid};de()({method:"post",url:(0,re.J4)("v2","settings/link/read"),data:t}).then((e=>{let t=e.data.link_config;this.address=t.address,this.available=t.available,this.name=t.name,this.version=t.version,this.enableReceivingTasks=t.enable_receiving_tasks,this.enableSendingTasks=t.enable_sending_tasks,this.enableTaskPreloading=t.enable_task_preloading,this.enableDistributedWorkerCount=t.enable_distributed_worker_count,this.distributedWorkerCountTarget=e.data.distributed_worker_count_target}))},saveInstallationLinkConfig:function(){let e={link_config:{uuid:this.currentUuid,address:this.address,enable_receiving_tasks:this.enableReceivingTasks,enable_sending_tasks:this.enableSendingTasks,enable_task_preloading:this.enableTaskPreloading,enable_distributed_worker_count:this.enableDistributedWorkerCount},distributed_worker_count_target:this.distributedWorkerCountTarget};de()({method:"post",url:(0,re.J4)("v2","settings/link/write"),data:e}).then((e=>{this.$q.notify({color:"positive",position:"top",icon:"cloud_done",message:this.$t("notifications.saved"),timeout:200})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToSaveSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}},watch:{uuid(e){e.length>0&&(this.currentUuid=this.uuid)}},data:function(){return{maximizedToggle:!0,currentUuid:(0,x.iH)(null),address:(0,x.iH)(""),available:(0,x.iH)(!1),name:(0,x.iH)(""),version:(0,x.iH)(""),enableReceivingTasks:(0,x.iH)(null),enableSendingTasks:(0,x.iH)(null),enableTaskPreloading:(0,x.iH)(null),enableDistributedWorkerCount:(0,x.iH)(null),distributedWorkerCountTarget:(0,x.iH)(null)}}};var ce=n(4260),me=n(6778),ge=n(151),pe=n(5589),he=n(2165),ke=n(8870),we=n(5869),be=n(4842),_e=n(4103),fe=n(8886),ve=n(2064),qe=n(8020),ye=n(677),Ie=n(7518),We=n.n(Ie);const $e=(0,ce.Z)(ue,[["render",ae]]),Te=$e;We()(ue,"components",{QDialog:me.Z,QCard:ge.Z,QCardSection:pe.Z,QBtn:he.Z,QTooltip:ke.Z,QSeparator:we.Z,QInput:be.Z,QSkeleton:_e.ZP,QToggle:fe.Z,QSlider:ve.Z}),We()(ue,"directives",{TouchSwipe:qe.Z,ClosePopup:ye.Z});const Ce={name:"SettingsLink",setup(){(0,R.Z)();const{t:e}=(0,z.QT)();let t=null,n=(0,Z.A)(e);function i(){t=n.init()}function l(){n.close()}(0,s.bv)((()=>{i()})),(0,s.Ah)((()=>{l()}))},data(){return{installationName:(0,x.iH)(null),remoteInstallations:(0,x.iH)(null),newRemoteInstallation:(0,x.iH)(!1),newRemoteInstallationAddress:(0,x.iH)("")}},methods:{fetchSettings:function(){de()({method:"get",url:(0,re.J4)("v2","settings/read")}).then((e=>{this.installationName=e.data.settings.installation_name;let t=[];for(let n=0;n<e.data.settings.remote_installations.length;n++){let s=e.data.settings.remote_installations[n];t[t.length]={address:s.address,enableReceivingTasks:s.enable_receiving_tasks,enableSendingTasks:s.enable_sending_tasks,name:s.name,version:s.version,uuid:s.uuid,available:s.available}}this.remoteInstallations=t})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToFetchSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},save:function(){let e=[];for(let n=0;n<this.remoteInstallations.length;n++)e[e.length]={address:this.remoteInstallations[n].address,enable_receiving_tasks:this.remoteInstallations[n].enableReceivingTasks,enable_sending_tasks:this.remoteInstallations[n].enableSendingTasks,name:this.remoteInstallations[n].name,version:this.remoteInstallations[n].version,uuid:this.remoteInstallations[n].uuid,available:this.remoteInstallations[n].available};let t={settings:{installation_name:this.installationName,remote_installations:e}};de()({method:"post",url:(0,re.J4)("v2","settings/write"),data:t}).then((e=>{this.fetchSettings(),this.$q.notify({color:"positive",position:"top",icon:"cloud_done",message:this.$t("notifications.saved"),timeout:200})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToSaveSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},addNewRemoteInstallation:function(){for(let t=0;t<this.remoteInstallations.length;t++)if(this.newRemoteInstallationAddress===this.remoteInstallations[t].address)return void this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.remoteInstallationAlreadyInList"),icon:"report_problem",actions:[{icon:"close",color:"white"}]});let e={address:this.newRemoteInstallationAddress};de()({method:"post",url:(0,re.J4)("v2","settings/link/validate"),data:e}).then((e=>{if("undefined"===typeof e.data.installation.settings.installation_name)this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.incompatibleRemoteInstallation"),icon:"report_problem",actions:[{icon:"close",color:"white"}]});else{let t=e.data.installation.settings.installation_name,n=e.data.installation.version,s=e.data.installation.session.uuid;this.remoteInstallations[this.remoteInstallations.length]={address:this.newRemoteInstallationAddress,enable_receiving_tasks:!1,enable_sending_tasks:!1,name:t,version:n,uuid:s,available:!0},this.save()}})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.invalidRemoteInstallationAddress"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},deleteRemoteInstallation:function(e){let t=[];for(let n=0;n<this.remoteInstallations.length;n++)n!==e&&(t[t.length]=this.remoteInstallations[n]);this.remoteInstallations=t},configureRemoteInstallation:function(e){let t=this.remoteInstallations[e];this.$q.dialog({component:Te,componentProps:{dialogHeader:this.$t("headers.configureRemoteInstallationLink"),uuid:t.uuid}}).onOk((e=>{})).onDismiss((()=>{this.fetchSettings()}))}},created(){this.fetchSettings()},computed:{dragOptions(){return{animation:100,group:"scheduleOrder",disabled:!1,ghostClass:"ghost",direction:"vertical",delay:200,delayOnTouchOnly:!0}}}};var Qe=n(4379),Se=n(5269),Ze=n(7011),xe=n(3414),Re=n(2035),ze=n(4027),Ve=n(2350),He=n(846),De=n(2025),je=n(9367);const Ue=(0,ce.Z)(Ce,[["render",S]]),Pe=Ue;We()(Ce,"components",{QPage:Qe.Z,QForm:Se.Z,QSkeleton:_e.ZP,QInput:be.Z,QSeparator:we.Z,QList:Ze.Z,QItem:xe.Z,QItemSection:Re.Z,QImg:ze.Z,QItemLabel:Ve.Z,QBtn:he.Z,QTooltip:ke.Z,QBar:He.Z,QSpace:De.Z,QDialog:me.Z,QCard:ge.Z,QCardSection:pe.Z,QCardActions:je.Z}),We()(Ce,"directives",{ClosePopup:ye.Z})}}]);