"use strict";(self["webpackChunkunmanic_frontend"]=self["webpackChunkunmanic_frontend"]||[]).push([[160],{2160:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Yt});var s=o(3673),l=o(2323);const a={class:"q-pa-none"},r={class:"row"},n={class:"col q-ma-sm"},i={class:"row items-center no-wrap"},c={class:"col"},d={class:"col-auto"},u={class:"row"},m={key:0,class:"full-width row flex-center text-accent q-gutter-sm"},p={class:"row"},w={class:"col-12 col-md-6"},g={class:"q-ma-sm"},f={class:"col-12 col-md-6"},k={class:"q-ma-sm"};function _(e,t,o,_,h,v){const b=(0,s.up)("q-icon"),W=(0,s.up)("q-item-label"),y=(0,s.up)("q-item-section"),q=(0,s.up)("q-item"),T=(0,s.up)("q-separator"),Z=(0,s.up)("q-list"),$=(0,s.up)("q-btn-dropdown"),Q=(0,s.up)("q-card-section"),L=(0,s.up)("WorkerProgress"),z=(0,s.up)("q-card"),P=(0,s.up)("PendingTasks"),S=(0,s.up)("CompletedTasks"),x=(0,s.up)("q-page"),C=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(x,{padding:""},{default:(0,s.w5)((()=>[(0,s._)("div",a,[(0,s._)("div",r,[(0,s._)("div",n,[(0,s.Wm)(z,null,{default:(0,s.w5)((()=>[(0,s.Wm)(Q,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s._)("div",i,[(0,s._)("div",c,[(0,s._)("div",{class:(0,l.C_)([e.$q.dark.isActive?"text-primary":"text-indigo-10","text-h6"])},[(0,s.Wm)(b,{name:"fas fa-spinner"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.workers")),1)],2)]),(0,s._)("div",d,[(0,s.Wm)($,{class:"q-ml-sm",color:0===Object.keys(_.workerProgressList).length?"grey-7":"secondary","disable-main-btn":0===Object.keys(_.workerProgressList).length,label:e.$t("navigation.options")},{default:(0,s.w5)((()=>[(0,s.Wm)(Z,null,{default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.j4)(q,{clickable:"",onClick:t[0]||(t[0]=e=>v.pauseAllWorkers())},{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(W,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b,{name:"pause"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.pauseAllWorkers")),1)])),_:1})])),_:1})])),_:1})),[[C]]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(q,{clickable:"",onClick:t[1]||(t[1]=e=>v.resumeAllWorkers())},{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(W,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b,{name:"play_arrow"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.resumeAllWorkers")),1)])),_:1})])),_:1})])),_:1})),[[C]]),(0,s.Wm)(T),(0,s.wy)(((0,s.wg)(),(0,s.j4)(q,{clickable:"",onClick:t[2]||(t[2]=e=>v.terminateAllWorkers())},{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(W,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b,{name:"fas fa-skull-crossbones"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.terminateAllWorkers")),1)])),_:1})])),_:1})])),_:1})),[[C]])])),_:1})])),_:1},8,["color","disable-main-btn","label"])])])])),_:1}),(0,s.Wm)(Q,null,{default:(0,s.w5)((()=>[(0,s._)("div",u,[0===Object.keys(_.workerProgressList).length?((0,s.wg)(),(0,s.iD)("div",m,[(0,s.Wm)(W,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.listEmpty")),1)])),_:1})])):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(_.workerProgressList,((e,t)=>((0,s.wg)(),(0,s.j4)(L,(0,s.dG)({key:t},e),null,16)))),128))])])),_:1})])),_:1})])]),(0,s._)("div",p,[(0,s._)("div",w,[(0,s._)("div",g,[(0,s.Wm)(P,(0,l.vs)((0,s.F4)(_.pendingTasksData)),null,16)])]),(0,s._)("div",f,[(0,s._)("div",k,[(0,s.Wm)(S,(0,l.vs)((0,s.F4)(_.completedTasksData)),null,16)])])])])])),_:1})}o(71);const h=e=>((0,s.dD)("data-v-5ae7d2d0"),e=e(),(0,s.Cn)(),e),v={class:"row items-center no-wrap"},b={class:"col"},W={key:0,class:"text-h8 text-primary"},y={key:1,class:"text-h8 text-primary"},q={class:"col-auto"},T={class:"row"},Z={class:"row"},$=h((()=>(0,s._)("div",{class:"column q-ml-sm"},"ETC:",-1))),Q={class:"column q-ml-lg"},L={class:"row items-center no-wrap"},z={class:"col"},P={class:"text-h6 text-primary"},S={class:"col-auto"},x={class:"row"},C={class:"row"};function U(e,t,o,a,r,n){const i=(0,s.up)("q-tooltip"),c=(0,s.up)("q-btn"),d=(0,s.up)("q-card-section"),u=(0,s.up)("q-separator"),m=(0,s.up)("q-avatar"),p=(0,s.up)("q-circular-progress"),w=(0,s.up)("q-item-label"),g=(0,s.up)("q-item-section"),f=(0,s.up)("q-item"),k=(0,s.up)("q-list"),_=(0,s.up)("WorkerProgressStatus"),h=(0,s.up)("WorkerProgressLog"),U=(0,s.up)("q-card"),D=(0,s.up)("q-dialog"),j=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(U,{inline:"",style:{width:"370px"},class:"worker-progress-card"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{class:"",maxlength:"2"},{default:(0,s.w5)((()=>[(0,s._)("div",v,[(0,s._)("div",b,[e.label.length<50?((0,s.wg)(),(0,s.iD)("div",W,(0,l.zw)(e.label),1)):((0,s.wg)(),(0,s.iD)("div",y,(0,l.zw)(e.label.substring(0,48)+".."),1))]),(0,s._)("div",q,[(0,s.Wm)(c,{onClick:t[0]||(t[0]=t=>e.workerProgressPopup=!0),color:"grey-7",dense:"",round:"",flat:"",icon:"open_in_full"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("navigation.showMore")),1)])),_:1})])),_:1})])])])),_:1}),(0,s.Wm)(u),(0,s._)("div",T,[(0,s.Wm)(d,{class:"q-pb-none col q-pb-none justify-center full-height full-width text-center"},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{indeterminate:e.indeterminate,"show-value":"",value:e.progress,size:"90px",thickness:.2,color:e.color,"center-color":e.$q.dark.isActive?"grey-10":"grey-3","track-color":"grey-7","font-size":"10px",class:"q-ma-md"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{size:"60px"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.progressText),1)])),_:1})])),_:1},8,["indeterminate","value","thickness","color","center-color"])])),_:1}),(0,s.Wm)(d,{class:"q-pb-none col-7"},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{bordered:"",padding:""},{default:(0,s.w5)((()=>[(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[(0,s.Wm)(g,null,{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.stateLabel")),1)])),_:1}),(0,s.Wm)(w,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.state),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[(0,s.Wm)(g,null,{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.currentRunnerLabel")),1)])),_:1}),(0,s.Wm)(w,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.currentRunner),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})]),(0,s.Wm)(d,{class:"q-pt-sm"},{default:(0,s.w5)((()=>[(0,s._)("div",Z,[$,(0,s._)("div",Q,(0,l.zw)(e.etc),1),(0,s.Wm)(i,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.etc")),1)])),_:1})])])),_:1}),(0,s.Wm)(d,{class:"q-pa-none"},{default:(0,s.w5)((()=>[(0,s.Wm)(D,{modelValue:e.workerProgressPopup,"onUpdate:modelValue":t[1]||(t[1]=t=>e.workerProgressPopup=t),"full-width":"","full-height":""},{default:(0,s.w5)((()=>[(0,s.Wm)(U,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s._)("div",L,[(0,s._)("div",z,[(0,s._)("div",P,(0,l.zw)(e.label),1)]),(0,s._)("div",S,[(0,s.wy)(((0,s.wg)(),(0,s.j4)(c,{color:"grey-7",dense:"",round:"",flat:"",icon:"close_fullscreen"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.close")),1)])),_:1})])),_:1})),[[j]])])])])),_:1}),(0,s.Wm)(d,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s._)("div",x,[(0,s.Wm)(d,{class:"col-12 col-md-7"},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{id:e.id,state:e.state,currentRunner:e.currentRunner,startTime:e.startTime,totalProcTime:e.totalProcTime,paused:e.paused,idle:e.idle},null,8,["id","state","currentRunner","startTime","totalProcTime","paused","idle"])])),_:1}),(0,s.Wm)(d,{class:"col-12 col-md q-pb-none justify-center full-height full-width text-center"},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{indeterminate:e.indeterminate,"show-value":"",value:e.progress,size:"90px",thickness:.2,color:e.color,"center-color":e.$q.dark.isActive?"grey-10":"grey-3","track-color":"grey-7","font-size":"10px",class:"q-ma-md"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{size:"60px"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.progressText),1)])),_:1})])),_:1},8,["indeterminate","value","thickness","color","center-color"])])),_:1})]),(0,s._)("div",C,[(0,s.Wm)(d,{class:"col"},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{workerLog:e.workerLog},null,8,["workerLog"])])),_:1})])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})}var D=o(1959);const j={class:"row items-center no-wrap"},I={class:"col"},H={class:"text-h6 text-grey-8"},R={class:"col-auto"};function A(e,t,o,a,r,n){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-item-label"),d=(0,s.up)("q-item-section"),u=(0,s.up)("q-item"),m=(0,s.up)("q-separator"),p=(0,s.up)("q-list"),w=(0,s.up)("q-btn-dropdown"),g=(0,s.up)("q-card-section"),f=(0,s.up)("q-card"),k=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(f,null,{default:(0,s.w5)((()=>[(0,s.Wm)(g,{class:"bg-card-head q-pa-sm"},{default:(0,s.w5)((()=>[(0,s._)("div",j,[(0,s._)("div",I,[(0,s._)("div",H,(0,l.zw)(e.$t("components.workers.status")),1)]),(0,s._)("div",R,[(0,s.Wm)(w,{class:"q-ml-sm",color:"secondary",label:e.$t("navigation.options")},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[o.paused?(0,s.wy)(((0,s.wg)(),(0,s.j4)(u,{key:0,clickable:"",onClick:t[0]||(t[0]=e=>n.resumeWorker())},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"play_arrow"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.resumeWorker")),1)])),_:1})])),_:1})])),_:1})),[[k]]):(0,s.wy)(((0,s.wg)(),(0,s.j4)(u,{key:1,clickable:"",onClick:t[1]||(t[1]=e=>n.pauseWorker())},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"pause"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.pauseWorker")),1)])),_:1})])),_:1})])),_:1})),[[k]]),(0,s.Wm)(m),(0,s.wy)(((0,s.wg)(),(0,s.j4)(u,{clickable:"",onClick:t[2]||(t[2]=e=>n.terminateWorkerPrompt())},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"fas fa-skull-crossbones"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.terminateWorker")),1)])),_:1})])),_:1})])),_:1})),[[k]])])),_:1})])),_:1},8,["label"])])])])),_:1}),(0,s.Wm)(m),(0,s.Wm)(p,{bordered:"",padding:""},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.stateLabel")),1)])),_:1}),(0,s.Wm)(c,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(o.state),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.currentRunnerLabel")),1)])),_:1}),(0,s.Wm)(c,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(o.currentRunner),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(u,{class:"worker-progress-card-state-t-start"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.startTimeLabel")),1)])),_:1}),(0,s.Wm)(c,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(o.startTime),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(u,{class:"worker-progress-card-state-t-total"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.totalProcessingTimeLabel")),1)])),_:1}),(0,s.Wm)(c,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(o.totalProcTime),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var B=o(52),N=o.n(B),J=o(7689);const V={setup(){return{}},props:{id:{type:String},state:{type:String,default:"Waiting for another task..."},currentRunner:{type:String,default:""},startTime:{type:String,default:""},totalProcTime:{type:String,default:""},idle:{type:Boolean},paused:{type:Boolean}},methods:{pauseWorker:function(){let e={worker_id:this.id};N()({method:"post",url:(0,J.J4)("v2","workers/worker/pause"),data:e}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerPaused"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerPausedFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},resumeWorker:function(){let e={worker_id:this.id};N()({method:"post",url:(0,J.J4)("v2","workers/worker/resume"),data:e}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerResumed"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerResumedFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},terminateWorker:function(){let e={worker_id:this.id};N()({method:"delete",url:(0,J.J4)("v2","workers/worker/terminate"),data:e}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerTerminated"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerTerminationFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},terminateWorkerPrompt:function(){this.idle?this.terminateWorker():this.$q.dialog({title:this.$t("headers.confirm"),message:this.$t("components.workers.terminateWorkerWarning"),cancel:!0,persistent:!0}).onOk((()=>{this.terminateWorker()}))}}};var M=o(4260),E=o(151),F=o(5589),O=o(2226),Y=o(7011),K=o(3414),G=o(2035),X=o(2350),ee=o(4554),te=o(5869),oe=o(677),se=o(7518),le=o.n(se);const ae=(0,M.Z)(V,[["render",A]]),re=ae;le()(V,"components",{QCard:E.Z,QCardSection:F.Z,QBtnDropdown:O.Z,QList:Y.Z,QItem:K.Z,QItemSection:G.Z,QItemLabel:X.Z,QIcon:ee.Z,QSeparator:te.Z}),le()(V,"directives",{ClosePopup:oe.Z});const ne={class:"row items-center no-wrap"},ie={class:"col"},ce={class:"text-h6 text-grey-8"},de={class:"q-ma-none q-pa-none"};function ue(e,t,o,a,r,n){const i=(0,s.up)("q-card-section"),c=(0,s.up)("q-separator"),d=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{class:"bg-card-head q-pa-sm"},{default:(0,s.w5)((()=>[(0,s._)("div",ne,[(0,s._)("div",ie,[(0,s._)("div",ce,(0,l.zw)(e.$t("components.workers.workerLog")),1)])])])),_:1}),(0,s.Wm)(c),(0,s.Wm)(i,{class:"q-pa-md"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.workerLog,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{key:t},[(0,s._)("p",de,(0,l.zw)(e),1)])))),128))])),_:1})])),_:1})}const me={setup(){return{}},props:{workerLog:{type:Array}}},pe=(0,M.Z)(me,[["render",ue]]),we=pe;le()(me,"components",{QCard:E.Z,QCardSection:F.Z,QSeparator:te.Z});const ge=(0,s.aZ)({name:"WorkerProgress",components:{WorkerProgressStatus:re,WorkerProgressLog:we},data(){return{workerProgressPopup:(0,D.iH)(!1)}},props:{id:{type:String,required:!0},label:{type:String,required:!0},name:{type:String,required:!0},progress:{type:Number,default:100},progressText:{type:String,default:""},etc:{type:String,default:""},color:{type:String,default:"warning"},state:{type:String,default:"Waiting for another task..."},currentRunner:{type:String,default:""},startTime:{type:String,default:""},totalProcTime:{type:String,default:""},indeterminate:{type:Boolean,default:!1},workerLog:{type:Array},idle:{type:Boolean},paused:{type:Boolean}}});var fe=o(2165),ke=o(8870),_e=o(6122),he=o(5096),ve=o(6778);const be=(0,M.Z)(ge,[["render",U],["__scopeId","data-v-5ae7d2d0"]]),We=be;le()(ge,"components",{QCard:E.Z,QCardSection:F.Z,QBtn:fe.Z,QTooltip:ke.Z,QSeparator:te.Z,QCircularProgress:_e.Z,QAvatar:he.Z,QList:Y.Z,QItem:K.Z,QItemSection:G.Z,QItemLabel:X.Z,QDialog:ve.Z}),le()(ge,"directives",{ClosePopup:oe.Z});const ye={class:"row items-center no-wrap"},qe={class:"col"},Te={class:"col-auto"},Ze={class:"q-pa-md"},$e={class:"full-width row flex-center text-accent q-gutter-sm"},Qe={class:"full-width row flex-center text-accent q-gutter-sm"},Le={class:"row"},ze=(0,s._)("div",{class:"col"},null,-1),Pe={class:"col"},Se={class:"row items-center no-wrap"},xe={class:"col"},Ce={class:"text-h6 text-amber-10"},Ue=(0,s.Uk)(" Pending Tasks "),De={class:"col-auto"},je={class:"q-pa-md"};function Ie(e,t,o,a,r,n){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-tooltip"),d=(0,s.up)("q-btn"),u=(0,s.up)("q-card-section"),m=(0,s.up)("q-item-label"),p=(0,s.up)("q-item-section"),w=(0,s.up)("q-item"),g=(0,s.up)("q-list"),f=(0,s.up)("q-space"),k=(0,s.up)("PendingTasksTable"),_=(0,s.up)("q-card"),h=(0,s.up)("q-dialog"),v=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s._)("div",ye,[(0,s._)("div",qe,[(0,s._)("div",{class:(0,l.C_)([e.$q.dark.isActive?"text-amber-8":"text-amber-10","text-h6"])},[(0,s.Wm)(i,{name:"fas fa-list-ul"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.pendingTasks")),1)],2)]),(0,s._)("div",Te,[(0,s.Wm)(d,{onClick:t[0]||(t[0]=t=>e.pendingTasksPopup=!0),color:"grey-7",dense:"",round:"",flat:"",icon:"open_in_full"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("navigation.showMore")),1)])),_:1})])),_:1})])])])),_:1}),(0,s.Wm)(u,{class:"q-pb-none"},{default:(0,s.w5)((()=>[(0,s._)("div",Ze,[(0,s.Wm)(g,{separator:""},{default:(0,s.w5)((()=>[e.taskList?e.taskList.length?((0,s.wg)(!0),(0,s.iD)(s.HY,{key:2},(0,s.Ko)(e.taskList,(e=>((0,s.wg)(),(0,s.j4)(w,(0,s.dG)({key:e.id},e),{default:(0,s.w5)((()=>[(0,s.Wm)(p,{avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"pending",class:"text-amber-10",style:{opacity:"0.8"}})])),_:1}),(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)))),128)):((0,s.wg)(),(0,s.j4)(w,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s._)("div",Qe,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("headers.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1})])),_:1})):((0,s.wg)(),(0,s.j4)(w,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s._)("div",$e,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("headers.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1})])),_:1}))])),_:1})])])),_:1}),(0,s.Wm)(u,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s._)("div",Le,[ze,(0,s._)("div",Pe,[(0,s.Wm)(d,{class:"float-right",label:e.$t("components.pendingTasks.rescanLibrary"),color:"secondary",onClick:t[1]||(t[1]=t=>e.rescanLibrary())},null,8,["label"])])]),(0,s.Wm)(f)])),_:1}),(0,s.Wm)(h,{modelValue:e.pendingTasksPopup,"onUpdate:modelValue":t[2]||(t[2]=t=>e.pendingTasksPopup=t),"full-width":"","full-height":""},{default:(0,s.w5)((()=>[(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s._)("div",Se,[(0,s._)("div",xe,[(0,s._)("div",Ce,[(0,s.Wm)(i,{name:"fas fa-list-ul"}),Ue])]),(0,s._)("div",De,[(0,s.wy)(((0,s.wg)(),(0,s.j4)(d,{color:"grey-7",dense:"",round:"",flat:"",icon:"close_fullscreen"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.close")),1)])),_:1})])),_:1})),[[v]])])])])),_:1}),(0,s.Wm)(u,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s._)("div",je,[(0,s.Wm)(k)])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}const He={class:"q-pa-md"},Re={class:"full-width row flex-center text-accent q-gutter-sm"};function Ae(e,t,o,a,r,n){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-input"),d=(0,s.up)("q-item-label"),u=(0,s.up)("q-item-section"),m=(0,s.up)("q-item"),p=(0,s.up)("q-separator"),w=(0,s.up)("q-list"),g=(0,s.up)("q-btn-dropdown"),f=(0,s.up)("q-table"),k=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)("div",He,[(0,s.Wm)(f,{title:"Pending Tasks",rows:a.rows,columns:a.columns,"row-key":"name",pagination:a.pagination,"onUpdate:pagination":t[1]||(t[1]=e=>a.pagination=e),loading:a.loading,filter:a.filter,onRequest:a.onRequest,"binary-state-sort":"","selected-rows-label":a.getSelectedString,selection:"multiple",selected:a.selected,"onUpdate:selected":t[2]||(t[2]=e=>a.selected=e)},{"top-left":(0,s.w5)((()=>[(0,s.Wm)(c,{filled:"",class:"shadow-1",dense:"",debounce:"300",color:"primary",modelValue:a.filter,"onUpdate:modelValue":t[0]||(t[0]=e=>a.filter=e),placeholder:e.$t("navigation.search")},{append:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"search"})])),_:1},8,["modelValue","placeholder"])])),"top-right":(0,s.w5)((()=>[(0,s.Wm)(g,{class:"q-ml-sm",color:"secondary",label:e.$t("navigation.options")},{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.j4)(m,{clickable:"",onClick:a.rescanLibrary},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"search"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.pendingTasks.rescanLibrary")),1)])),_:1})])),_:1})])),_:1},8,["onClick"])),[[k]]),(0,s.Wm)(p),(0,s.wy)(((0,s.wg)(),(0,s.j4)(m,{clickable:"",onClick:a.moveToTop},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"arrow_upward"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.pendingTasks.moveToTop")),1)])),_:1})])),_:1})])),_:1},8,["onClick"])),[[k]]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(m,{clickable:"",onClick:a.moveToBottom},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"arrow_downward"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.pendingTasks.moveToBottom")),1)])),_:1})])),_:1})])),_:1},8,["onClick"])),[[k]]),(0,s.Wm)(p),(0,s.wy)(((0,s.wg)(),(0,s.j4)(m,{clickable:"",onClick:a.deleteSelected},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"delete_outline"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.pendingTasks.removeSelected")),1)])),_:1})])),_:1})])),_:1},8,["onClick"])),[[k]])])),_:1})])),_:1},8,["label"])])),"no-data":(0,s.w5)((()=>[(0,s._)("div",Re,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("headers.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1},8,["rows","columns","pagination","loading","filter","onRequest","selected-rows-label","selected"])])}var Be=o(8825),Ne=o(5948);const Je=[{name:"id",label:"Name",required:!0,align:"left",field:e=>e.name,format:e=>`${e}`,sortable:!1},{name:"library",label:"Library",required:!0,align:"left",field:e=>e.libraryName,sortable:!1}],Ve={setup(){const e=(0,Be.Z)(),{t}=(0,Ne.QT)(),o=(0,D.iH)([]),l=(0,D.iH)(""),a=(0,D.iH)(!1),r=(0,D.iH)({sortBy:"priority",descending:!0,page:1,rowsPerPage:15,rowsNumber:10}),n=(0,D.iH)([]),i=(0,D.iH)(null);let c=null;function d(){let e="";return 0!==n.value.length&&(e=`${n.value.length} record${n.value.length>1?"s":""} selected of ${o.value.length}`),e}function u(){N()({method:"post",url:(0,J.J4)("v2","pending/rescan")}).then((e=>{i.value=e.data})).catch((()=>{e.notify({color:"negative",position:"top",message:t("notifications.rescanLibraryError"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}function m(){if(0!==n.value.length){let e=[];for(let o=0;o<n.value.length;o++){let t=n.value[o];e[e.length]=t.id}let t={id_list:e,position:"top"};w(t)}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function p(){if(0!==n.value.length){let e=[];for(let o=0;o<n.value.length;o++){let t=n.value[o];e[e.length]=t.id}let t={id_list:e,position:"bottom"};w(t)}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function w(t){N()({method:"post",url:(0,J.J4)("v2","pending/reorder"),data:t}).then((e=>{i.value=e.data,f({pagination:r.value,filter:l.value})})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting a task reorder",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}function g(){if(0!==n.value.length){let t=[];for(let e=0;e<n.value.length;e++){let o=n.value[e];t[t.length]=o.id}let o={id_list:t};N()({method:"delete",url:(0,J.J4)("v2","pending/tasks"),data:o}).then((e=>{f({pagination:r.value,filter:l.value})})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the selected tasks be deleted",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function f(t){const{page:s,rowsPerPage:l,sortBy:n,descending:i}=t.pagination,c=t.filter;a.value=!0;const d=0===l?r.value.rowsNumber:l,u=(s-1)*l;let m={start:u,length:d,search_value:c,order_by:n,order_direction:i?"desc":"asc"};N()({method:"post",url:(0,J.J4)("v2","pending/tasks"),data:m}).then((e=>{r.value.rowsNumber=e.data.recordsFiltered;const t=[];for(let o=0;o<e.data.results.length;o++){let s=e.data.results[o];t[o]={id:s.id,name:s.abspath,libraryName:s.library_name,completed:s.finish_time,status:s.success?"Success":"Failed"}}o.value.splice(0,o.value.length,...t),r.value.page=s,r.value.rowsPerPage=l,r.value.sortBy=n,r.value.descending=i,a.value=!1})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the pending tasks list",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}return(0,s.bv)((()=>{f({pagination:r.value,filter:void 0}),c=setInterval((()=>{f({pagination:r.value,filter:l.value})}),1e4)})),(0,s.Ah)((()=>{null!=c&&clearInterval(c)})),{selected:n,filter:l,loading:a,pagination:r,columns:Je,rows:o,getSelectedString:d,onRequest:f,rescanLibrary:u,moveToTop:m,moveToBottom:p,deleteSelected:g,reloadTable(){f({pagination:r.value,filter:l.value})}}}};var Me=o(6429),Ee=o(4842);const Fe=(0,M.Z)(Ve,[["render",Ae]]),Oe=Fe;le()(Ve,"components",{QTable:Me.Z,QInput:Ee.Z,QIcon:ee.Z,QBtnDropdown:O.Z,QList:Y.Z,QItem:K.Z,QItemSection:G.Z,QItemLabel:X.Z,QSeparator:te.Z}),le()(Ve,"directives",{ClosePopup:oe.Z});const Ye=(0,s.aZ)({name:"PendingTasks",components:{PendingTasksTable:Oe},data(){return{pendingTasksPopup:(0,D.iH)(!1)}},props:{taskList:{type:Array,required:!0}},methods:{rescanLibrary:function(){N()({method:"post",url:(0,J.J4)("v2","pending/rescan")}).then((e=>{})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.rescanLibraryError"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}}});var Ke=o(2025);const Ge=(0,M.Z)(Ye,[["render",Ie]]),Xe=Ge;le()(Ye,"components",{QCard:E.Z,QCardSection:F.Z,QIcon:ee.Z,QBtn:fe.Z,QTooltip:ke.Z,QList:Y.Z,QItem:K.Z,QItemSection:G.Z,QItemLabel:X.Z,QSpace:Ke.Z,QDialog:ve.Z}),le()(Ye,"directives",{ClosePopup:oe.Z});const et={class:"row items-center no-wrap"},tt={class:"col"},ot={class:"col-auto"},st={class:"q-pa-md"},lt={class:"full-width row flex-center text-accent q-gutter-sm"},at={class:"full-width row flex-center text-accent q-gutter-sm"},rt={class:"row"},nt={class:"column justify-center"},it={class:"column justify-center"},ct={class:"row items-center no-wrap"},dt={class:"col"},ut={class:"text-h6 text-blue-10"},mt={class:"col-auto"},pt={class:"q-pa-md"};function wt(e,t,o,a,r,n){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-tooltip"),d=(0,s.up)("q-btn"),u=(0,s.up)("q-card-section"),m=(0,s.up)("q-item-label"),p=(0,s.up)("q-item-section"),w=(0,s.up)("q-item"),g=(0,s.up)("q-list"),f=(0,s.up)("CompletedTasksTable"),k=(0,s.up)("q-card"),_=(0,s.up)("q-dialog"),h=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(k,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s._)("div",et,[(0,s._)("div",tt,[(0,s._)("div",{class:(0,l.C_)([e.$q.dark.isActive?"text-cyan-8":"text-cyan-10","text-h6"])},[(0,s.Wm)(i,{name:"fas fa-list-ul"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.completedTasks")),1)],2)]),(0,s._)("div",ot,[(0,s.Wm)(d,{onClick:t[0]||(t[0]=t=>e.completedTasksPopup=!0),color:"grey-7",dense:"",round:"",flat:"",icon:"open_in_full"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("navigation.showMore")),1)])),_:1})])),_:1})])])])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s._)("div",st,[(0,s.Wm)(g,{separator:""},{default:(0,s.w5)((()=>[e.taskList?e.taskList.length?((0,s.wg)(!0),(0,s.iD)(s.HY,{key:2},(0,s.Ko)(e.taskList,(e=>((0,s.wg)(),(0,s.j4)(w,(0,s.dG)({key:e.id},e),{default:(0,s.w5)((()=>[(0,s.Wm)(p,{avatar:""},{default:(0,s.w5)((()=>[e.success?((0,s.wg)(),(0,s.j4)(i,{key:0,name:"check_circle",class:"text-secondary",style:{opacity:"0.8"}})):((0,s.wg)(),(0,s.j4)(i,{key:1,name:"cancel",class:"text-negative",style:{opacity:"0.8"}}))])),_:2},1024),(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.label),1)])),_:2},1024)])),_:2},1024),(0,s.Wm)(p,{side:"",top:""},{default:(0,s.w5)((()=>[(0,s._)("div",rt,[(0,s._)("div",nt,[(0,s.Wm)(m,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.dateTimeSinceCompleted),1)])),_:2},1024)]),(0,s._)("div",it,[(0,s.Wm)(i,{class:"q-ml-sm",name:"event",size:"18px"})])])])),_:2},1024)])),_:2},1040)))),128)):((0,s.wg)(),(0,s.j4)(w,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s._)("div",at,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("headers.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1})])),_:1})):((0,s.wg)(),(0,s.j4)(w,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s._)("div",lt,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("headers.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1})])),_:1}))])),_:1})])])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(_,{modelValue:e.completedTasksPopup,"onUpdate:modelValue":t[1]||(t[1]=t=>e.completedTasksPopup=t),"full-width":"","full-height":""},{default:(0,s.w5)((()=>[(0,s.Wm)(k,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s._)("div",ct,[(0,s._)("div",dt,[(0,s._)("div",ut,[(0,s.Wm)(i,{name:"fas fa-list-ul"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.completedTasks")),1)])]),(0,s._)("div",mt,[(0,s.wy)(((0,s.wg)(),(0,s.j4)(d,{color:"grey-7",dense:"",round:"",flat:"",icon:"close_fullscreen"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.close")),1)])),_:1})])),_:1})),[[h]])])])])),_:1}),(0,s.Wm)(u,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s._)("div",pt,[(0,s.Wm)(f)])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})}const gt={class:"q-pa-md"},ft={class:"row"},kt={class:"row"},_t={class:"full-width row flex-center text-accent q-gutter-sm"},ht={class:"text-h6"};function vt(e,t,o,a,r,n){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-input"),d=(0,s.up)("q-item-label"),u=(0,s.up)("q-item-section"),m=(0,s.up)("q-item"),p=(0,s.up)("q-separator"),w=(0,s.up)("q-list"),g=(0,s.up)("q-btn-dropdown"),f=(0,s.up)("q-badge"),k=(0,s.up)("q-td"),_=(0,s.up)("q-btn"),h=(0,s.up)("q-table"),v=(0,s.up)("q-card-section"),b=(0,s.up)("q-select"),W=(0,s.up)("q-card-actions"),y=(0,s.up)("q-card"),q=(0,s.up)("q-dialog"),T=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",gt,[(0,s.Wm)(h,{title:"Completed Tasks",rows:a.rows,columns:a.columns,"row-key":"id",pagination:a.pagination,"onUpdate:pagination":t[1]||(t[1]=e=>a.pagination=e),loading:a.loading,filter:a.filter,onRequest:a.onRequest,"binary-state-sort":"","selected-rows-label":a.getSelectedString,selection:"multiple",selected:a.selected,"onUpdate:selected":t[2]||(t[2]=e=>a.selected=e)},{"top-left":(0,s.w5)((()=>[(0,s.Wm)(c,{filled:"",class:"shadow-1",dense:"",debounce:"300",color:"primary",modelValue:a.filter,"onUpdate:modelValue":t[0]||(t[0]=e=>a.filter=e),placeholder:e.$t("navigation.search")},{append:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"search"})])),_:1},8,["modelValue","placeholder"])])),"top-right":(0,s.w5)((()=>[(0,s.Wm)(g,{class:"q-ml-sm",color:"secondary",label:e.$t("navigation.options")},{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.j4)(m,{clickable:"",onClick:a.selectLibraryForRecreateTask},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"add"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.completedTasks.addToPendingTasksList")),1)])),_:1})])),_:1})])),_:1},8,["onClick"])),[[T]]),(0,s.Wm)(p),(0,s.wy)(((0,s.wg)(),(0,s.j4)(m,{clickable:"",onClick:a.deleteSelected},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"delete_outline"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.completedTasks.removeSelected")),1)])),_:1})])),_:1})])),_:1},8,["onClick"])),[[T]])])),_:1})])),_:1},8,["label"])])),"body-cell-task_success":(0,s.w5)((t=>[(0,s.Wm)(k,{props:t},{default:(0,s.w5)((()=>[(0,s._)("div",ft,[t.row.status?((0,s.wg)(),(0,s.j4)(f,{key:0,color:"positive",class:"shadow-1"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("status.success")),1)])),_:1})):((0,s.wg)(),(0,s.j4)(f,{key:1,color:"negative",class:"shadow-1"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("status.failed")),1)])),_:1}))])])),_:2},1032,["props"])])),"body-cell-details":(0,s.w5)((t=>[(0,s.Wm)(k,{props:t},{default:(0,s.w5)((()=>[(0,s._)("div",kt,[(0,s.Wm)(_,{onClick:e=>a.openDetailsDialog(t.row.id),color:"secondary",label:e.$t("components.completedTasks.details")},null,8,["onClick","label"])])])),_:2},1032,["props"])])),"no-data":(0,s.w5)((()=>[(0,s._)("div",_t,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("headers.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1},8,["rows","columns","pagination","loading","filter","onRequest","selected-rows-label","selected"])]),(0,s.Wm)(q,{modelValue:a.selectLibrary,"onUpdate:modelValue":t[4]||(t[4]=e=>a.selectLibrary=e),persistent:""},{default:(0,s.w5)((()=>[(0,s.Wm)(y,{style:{"min-width":"350px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(v,null,{default:(0,s.w5)((()=>[(0,s._)("div",ht,(0,l.zw)(e.$t("headers.selectLibrary")),1)])),_:1}),(0,s.Wm)(v,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s.Wm)(b,{filled:"","emit-value":"","map-options":"",modelValue:a.selectedLibraryId,"onUpdate:modelValue":t[3]||(t[3]=e=>a.selectedLibraryId=e),options:a.LibraryOptions,label:e.$t("components.completedTasks.selectLibraryToAdd")},null,8,["modelValue","options","label"])])),_:1}),(0,s.Wm)(W,{align:"right",class:"text-primary"},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(_,{flat:"",label:e.$t("navigation.cancel")},null,8,["label"]),[[T]]),(0,s.wy)((0,s.Wm)(_,{onClick:a.addSelectedToPendingTaskList,flat:"",label:e.$t("navigation.submit")},null,8,["onClick","label"]),[[T]])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}var bt=o(5616);const Wt={printTimeSinceDate(e){let t=new Date,o=Math.floor((t-e)/1e3),s=Math.floor(o/60),l=Math.floor(s/60),a=Math.floor(l/24);return l-=24*a,s=s-24*a*60-60*l,o=o-24*a*60*60-60*l*60-60*s,"Days: "+a+" Hours: "+l+" Minutes: "+s+" Seconds: "+o},printTimeAsHoursMinsSeconds(e){e=Number(e);let t=Math.floor(e/3600),o=Math.floor(e%3600/60),s=Math.floor(e%3600%60),l=t>0?t+(1==t?" hour, ":" hours, "):"",a=o>0?o+(1==o?" minute, ":" minutes, "):"",r=s>0?s+(1==s?" second":" seconds"):"";return l+a+r},printDateTimeString(e){let t=new Date(0);return t.setUTCSeconds(e),bt.ZP.formatDate(t,"YYYY-MM-DD HH:mm:ss")}},yt={class:"row items-center no-wrap"},qt={class:"col-auto"},Tt={class:"col"},Zt={class:"text-h6 text-secondary"},$t={class:"q-pt-md q-px-lg",style:{width:"2000px","max-width":"95vw"}},Qt={class:"q-pa-md completed-task-details-dialog-content"},Lt=["innerHTML"];function zt(e,t,o,a,r,n){const i=(0,s.up)("q-tooltip"),c=(0,s.up)("q-btn"),d=(0,s.up)("q-icon"),u=(0,s.up)("q-card-section"),m=(0,s.up)("q-card"),p=(0,s.up)("q-dialog"),w=(0,s.Q2)("close-popup"),g=(0,s.Q2)("touch-swipe");return(0,s.wg)(),(0,s.j4)(p,{ref:"dialogRef",maximized:e.$q.platform.is.mobile,"transition-show":"slide-right","transition-hide":"slide-left","full-height":"",position:"left",onHide:n.onDialogHide},{default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.j4)(m,{style:{"max-width":"100vw"}},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s._)("div",yt,[(0,s._)("div",qt,[(0,s.wy)(((0,s.wg)(),(0,s.j4)(c,{color:"grey-7",dense:"",round:"",flat:"",icon:"arrow_back"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.back")),1)])),_:1})])),_:1})),[[w]])]),(0,s._)("div",Tt,[(0,s._)("div",Zt,[(0,s.Wm)(d,{name:"description"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.completedTaskDetails")),1)])])])])),_:1}),(0,s.Wm)(u,{class:"q-pt-none q-pa-none"},{default:(0,s.w5)((()=>[(0,s._)("div",$t,[(0,s._)("div",Qt,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.taskDetails,((e,t)=>((0,s.wg)(),(0,s.iD)("p",{key:t,innerHTML:e},null,8,Lt)))),128))])])])),_:1})])),_:1})),[[g,n.hide,void 0,{touch:!0,left:!0}]])])),_:1},8,["maximized","onHide"])}const Pt={name:"CompletedTaskLogDialog",props:{completedTaskId:{type:String}},emits:["ok","hide","path"],methods:{show(){this.$refs.dialogRef.show()},hide(){this.$refs.dialogRef.hide()},onDialogHide(){this.$emit("hide")},fetchCompletedTaskLog:function(){let e={task_id:this.completedTaskId};N()({method:"post",url:(0,J.J4)("v2","history/task/log"),data:e}).then((e=>{this.taskDetails=e.data.command_log_lines})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.completedTasks.errorGettingDetails"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}},created(){this.fetchCompletedTaskLog()},data:function(){return{taskDetails:(0,D.iH)([])}}};var St=o(8020);const xt=(0,M.Z)(Pt,[["render",zt]]),Ct=xt;le()(Pt,"components",{QDialog:ve.Z,QCard:E.Z,QCardSection:F.Z,QBtn:fe.Z,QTooltip:ke.Z,QIcon:ee.Z}),le()(Pt,"directives",{TouchSwipe:St.Z,ClosePopup:oe.Z});const Ut=[{name:"task_label",label:"Name",required:!0,align:"left",field:"name",sortable:!0},{name:"finish_time",label:"Completed",required:!0,align:"left",field:"dateTimeCompleted",sortable:!0},{name:"task_success",label:"Status",required:!0,align:"left",field:"status",sortable:!0},{name:"details",label:"Details",required:!0,align:"left",field:"id",sortable:!1}],Dt={setup(){const e=(0,Be.Z)(),{t}=(0,Ne.QT)(),o=(0,D.iH)([]),l=(0,D.iH)(""),a=(0,D.iH)(!1),r=(0,D.iH)({sortBy:"finish_time",descending:!0,page:1,rowsPerPage:15,rowsNumber:10}),n=(0,D.iH)([]),i=(0,D.iH)(!1),c=(0,D.iH)(null),d=(0,D.iH)([]);function u(){let e="";return 0!==n.value.length&&(e=`${n.value.length} record${n.value.length>1?"s":""} selected of ${o.value.length}`),e}function m(){if(0!==n.value.length){let t=[];for(let e=0;e<n.value.length;e++){let o=n.value[e];t[t.length]=o.id}let o={id_list:t};N()({method:"delete",url:(0,J.J4)("v2","history/tasks"),data:o}).then((e=>{g({pagination:r.value,filter:l.value})})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the selected tasks be deleted",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function p(){N()({method:"get",url:(0,J.J4)("v2","settings/libraries")}).then((e=>{let t,o=[];for(let s=0;s<e.data.libraries.length;s++){let l=e.data.libraries[s];"undefined"===typeof t&&(t=l.id),o[o.length]={label:l.name,value:l.id}}d.value=o,c.value=1,1===o.length?(c.value=t,w()):i.value=!0})).catch((()=>{e.notify({color:"negative",position:"top",message:t("notifications.failedToFetchLibraryList"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}function w(){if(0!==n.value.length){let t=[];for(let e=0;e<n.value.length;e++){let o=n.value[e];t[t.length]=o.id}let o=c.value,s={id_list:t,library_id:o};N()({method:"post",url:(0,J.J4)("v2","history/reprocess"),data:s}).then((e=>{g({pagination:r.value,filter:l.value})})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the selected tasks be added to the pending tasks list",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function g(t){const{page:s,rowsPerPage:l,sortBy:n,descending:i}=t.pagination,c=t.filter;a.value=!0;const d=0===l?r.value.rowsNumber:l,u=(s-1)*l;let m={start:u,length:d,search_value:c,order_by:n,order_direction:i?"desc":"asc"};N()({method:"post",url:(0,J.J4)("v2","history/tasks"),data:m}).then((e=>{r.value.rowsNumber=e.data.recordsFiltered;const t=[];for(let o=0;o<e.data.results.length;o++){let s=e.data.results[o];t[o]={id:s.id,name:s.task_label,dateTimeCompleted:Wt.printDateTimeString(s.finish_time),status:s.task_success}}o.value.splice(0,o.value.length,...t),r.value.page=s,r.value.rowsPerPage=l,r.value.sortBy=n,r.value.descending=i,a.value=!1})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the completed tasks list",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}function f(t){e.dialog({component:Ct,componentProps:{completedTaskId:t}}).onOk((e=>{})).onDismiss((()=>{}))}return(0,s.bv)((()=>{g({pagination:r.value,filter:void 0})})),{selected:n,filter:l,loading:a,pagination:r,columns:Ut,rows:o,selectLibrary:i,selectedLibraryId:c,LibraryOptions:d,getSelectedString:u,onRequest:g,deleteSelected:m,selectLibraryForRecreateTask:p,addSelectedToPendingTaskList:w,openDetailsDialog:f}}};var jt=o(3884),It=o(9721),Ht=o(8516),Rt=o(9367);const At=(0,M.Z)(Dt,[["render",vt]]),Bt=At;le()(Dt,"components",{QTable:Me.Z,QInput:Ee.Z,QIcon:ee.Z,QBtnDropdown:O.Z,QList:Y.Z,QItem:K.Z,QItemSection:G.Z,QItemLabel:X.Z,QSeparator:te.Z,QTd:jt.Z,QBadge:It.Z,QBtn:fe.Z,QDialog:ve.Z,QCard:E.Z,QCardSection:F.Z,QSelect:Ht.Z,QCardActions:Rt.Z}),le()(Dt,"directives",{ClosePopup:oe.Z});const Nt=(0,s.aZ)({name:"CompletedTasks",components:{CompletedTasksTable:Bt},data(){return{completedTasksPopup:(0,D.iH)(!1)}},props:{taskList:{type:Array,required:!0}}}),Jt=(0,M.Z)(Nt,[["render",wt]]),Vt=Jt;le()(Nt,"components",{QCard:E.Z,QCardSection:F.Z,QIcon:ee.Z,QBtn:fe.Z,QTooltip:ke.Z,QList:Y.Z,QItem:K.Z,QItemSection:G.Z,QItemLabel:X.Z,QDialog:ve.Z}),le()(Nt,"directives",{ClosePopup:oe.Z});var Mt=o(4190);const Et={name:"Dashboard",components:{CompletedTasks:Vt,WorkerProgress:We,PendingTasks:Xe},setup(){const{t:e}=(0,Ne.QT)(),t=((0,Be.Z)(),(0,D.iH)([])),o=(0,D.iH)({taskList:[]}),l=(0,D.iH)({taskList:[]});let a=null,r=(0,Mt.A)(e);function n(o){function s(e,t){let o=100-parseInt(e);return parseInt(t)/parseInt(e)*o}let l={};for(let t=0;t<o.length;t++){let a=o[t];if(l["worker-"+a.id]={indeterminate:!1,id:a.id,label:a.name,name:a.name,color:"warning",progress:100,progressText:"-",etc:"...",state:e("components.workers.state.waiting"),currentRunner:e("components.workers.currentRunner.none"),startTime:"",totalProcTime:"",workerLog:[],idle:a.idle,paused:a.paused},a.paused&&(l["worker-"+a.id].label="...",l["worker-"+a.id].color="negative",l["worker-"+a.id].progressText="...",l["worker-"+a.id].state=e("components.workers.state.paused")),!a.idle){l["worker-"+a.id].label=a.name+": "+a.current_file,l["worker-"+a.id].color="secondary",l["worker-"+a.id].state=e("components.workers.state.processing");let t=e("components.workers.currentRunner.indeterminate");if("object"===typeof a.runners_info&&null!==a.runners_info)for(const[e,s]of Object.entries(a.runners_info))"in_progress"===s.status&&(t=s.name);l["worker-"+a.id].currentRunner=t;let o=new Date(1e3*a.start_time);l["worker-"+a.id].startTime=Wt.printDateTimeString(a.start_time),l["worker-"+a.id].totalProcTime=Wt.printTimeSinceDate(o),l["worker-"+a.id].workerLog=a.worker_log_tail,"undefined"!==typeof a.subprocess.percent&&""!==a.subprocess.percent?(l["worker-"+a.id].progress=Number(a.subprocess.percent),l["worker-"+a.id].progressText=a.subprocess.percent+"%",l["worker-"+a.id].etc=Wt.printTimeAsHoursMinsSeconds(s(a.subprocess.percent,a.subprocess.elapsed))):(l["worker-"+a.id].indeterminate=!0,l["worker-"+a.id].progressText="..."),a.paused&&(l["worker-"+a.id].indeterminate=!0,l["worker-"+a.id].color="negative",l["worker-"+a.id].state=e("components.workers.state.paused"))}}t.value=l}function i(e){let t,s=[];for(let o=0;o<e.results.length;o++)t=e.results[o],s[o]={id:e.results[o].id,priority:e.results[o].priority,label:e.results[o].label,status:e.results[o].status};o.value.taskList=s}function c(e){let t,o=[];for(let s=0;s<e.results.length;s++)t=e.results[s],o[s]={id:e.results[s].id,label:e.results[s].label,dateTimeCompleted:Wt.printDateTimeString(e.results[s].finish_time),dateTimeSinceCompleted:e.results[s].human_readable_time,success:e.results[s].success};l.value.taskList=o}function d(){a=r.init();let e=r.serverId;r.addEventListener("open","start_dashboard_messages",(function(e){a.send(JSON.stringify({command:"start_workers_info",params:{}})),a.send(JSON.stringify({command:"start_pending_tasks_info",params:{}})),a.send(JSON.stringify({command:"start_completed_tasks_info",params:{}}))})),r.addEventListener("message","handle_dashboard_messages",(function(t){if("string"===typeof t.data){let o=JSON.parse(t.data);if(o.success)switch(null===e?e=o.server_id:o.server_id!==e&&(console.debug("Unmanic server has restarted. Reloading page..."),location.reload()),o.type){case"workers_info":n(o.data);break;case"pending_tasks":i(o.data);break;case"completed_tasks":c(o.data);break}else console.error("WebSocket Error: Received contained errors - "+t.data)}else console.error("WebSocket Error: Received data was not JSON - "+t.data)}))}function u(){r.close()}return(0,s.bv)((()=>{d()})),(0,s.Ah)((()=>{u()})),{workerProgressList:t,pendingTasksData:o,completedTasksData:l}},methods:{pauseAllWorkers:function(){N()({method:"post",url:(0,J.J4)("v2","workers/worker/pause/all"),data:{}}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerPaused"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerPausedFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},resumeAllWorkers:function(){N()({method:"post",url:(0,J.J4)("v2","workers/worker/resume/all"),data:{}}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerResumed"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerResumedFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},terminateWorker:function(e){let t={worker_id:e};N()({method:"delete",url:(0,J.J4)("v2","workers/worker/terminate"),data:t}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerTerminated"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerTerminationFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},terminateAllWorkers:function(){for(let e in this.workerProgressList){let t=this.workerProgressList[e];t.idle?this.terminateWorker(t.id):this.$q.dialog({title:this.$t("headers.confirm")+" - "+t.name,message:this.$t("components.workers.terminateWorkerWarning"),cancel:!0,persistent:!0}).onOk((()=>{this.terminateWorker(t.id)}))}}}};var Ft=o(4379);const Ot=(0,M.Z)(Et,[["render",_]]),Yt=Ot;le()(Et,"components",{QPage:Ft.Z,QCard:E.Z,QCardSection:F.Z,QIcon:ee.Z,QBtnDropdown:O.Z,QList:Y.Z,QItem:K.Z,QItemSection:G.Z,QItemLabel:X.Z,QSeparator:te.Z}),le()(Et,"directives",{ClosePopup:oe.Z})}}]);