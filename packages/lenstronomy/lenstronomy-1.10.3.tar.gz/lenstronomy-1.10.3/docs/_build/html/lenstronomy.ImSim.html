
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>lenstronomy.ImSim package &#8212; lenstronomy 1.10.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="lenstronomy.ImSim.MultiBand package" href="lenstronomy.ImSim.MultiBand.html" />
    <link rel="prev" title="lenstronomy.GalKin package" href="lenstronomy.GalKin.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="lenstronomy.ImSim.MultiBand.html" title="lenstronomy.ImSim.MultiBand package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="lenstronomy.GalKin.html" title="lenstronomy.GalKin package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">lenstronomy 1.10.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="lenstronomy.html" accesskey="U">lenstronomy package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">lenstronomy.ImSim package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="lenstronomy-imsim-package">
<h1>lenstronomy.ImSim package<a class="headerlink" href="#lenstronomy-imsim-package" title="Permalink to this headline">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="lenstronomy.ImSim.MultiBand.html">lenstronomy.ImSim.MultiBand package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.MultiBand.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.MultiBand.html#module-lenstronomy.ImSim.MultiBand.joint_linear">lenstronomy.ImSim.MultiBand.joint_linear module</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.MultiBand.html#module-lenstronomy.ImSim.MultiBand.multi_data_base">lenstronomy.ImSim.MultiBand.multi_data_base module</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.MultiBand.html#module-lenstronomy.ImSim.MultiBand.multi_linear">lenstronomy.ImSim.MultiBand.multi_linear module</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.MultiBand.html#module-lenstronomy.ImSim.MultiBand.single_band_multi_model">lenstronomy.ImSim.MultiBand.single_band_multi_model module</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.MultiBand.html#module-lenstronomy.ImSim.MultiBand">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lenstronomy.ImSim.Numerics.html">lenstronomy.ImSim.Numerics package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.Numerics.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.Numerics.html#module-lenstronomy.ImSim.Numerics.adaptive_numerics">lenstronomy.ImSim.Numerics.adaptive_numerics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.Numerics.html#module-lenstronomy.ImSim.Numerics.convolution">lenstronomy.ImSim.Numerics.convolution module</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.Numerics.html#module-lenstronomy.ImSim.Numerics.grid">lenstronomy.ImSim.Numerics.grid module</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.Numerics.html#module-lenstronomy.ImSim.Numerics.numba_convolution">lenstronomy.ImSim.Numerics.numba_convolution module</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.Numerics.html#module-lenstronomy.ImSim.Numerics.numerics">lenstronomy.ImSim.Numerics.numerics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.Numerics.html#module-lenstronomy.ImSim.Numerics.partial_image">lenstronomy.ImSim.Numerics.partial_image module</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.Numerics.html#module-lenstronomy.ImSim.Numerics.point_source_rendering">lenstronomy.ImSim.Numerics.point_source_rendering module</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenstronomy.ImSim.Numerics.html#module-lenstronomy.ImSim.Numerics">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-lenstronomy.ImSim.de_lens">
<span id="lenstronomy-imsim-de-lens-module"></span><h2>lenstronomy.ImSim.de_lens module<a class="headerlink" href="#module-lenstronomy.ImSim.de_lens" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="lenstronomy.ImSim.de_lens.get_param_WLS">
<span class="sig-prename descclassname"><span class="pre">lenstronomy.ImSim.de_lens.</span></span><span class="sig-name descname"><span class="pre">get_param_WLS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_D_inv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_bool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/de_lens.html#get_param_WLS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.de_lens.get_param_WLS" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the parameter values given
:param A: response matrix Nd x Ns (Nd = # data points, Ns = # parameters)
:param C_D_inv: inverse covariance matrix of the data, Nd x Nd, diagonal form
:param d: data array, 1-d Nd
:param inv_bool: boolean, wheter returning also the inverse matrix or just solve the linear system
:return: 1-d array of parameter values</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lenstronomy.ImSim.de_lens.marginalisation_const">
<span class="sig-prename descclassname"><span class="pre">lenstronomy.ImSim.de_lens.</span></span><span class="sig-name descname"><span class="pre">marginalisation_const</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M_inv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/de_lens.html#marginalisation_const"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.de_lens.marginalisation_const" title="Permalink to this definition">¶</a></dt>
<dd><p>get marginalisation constant 1/2 log(M_beta) for flat priors
:param M_inv: 2D covariance matrix
:return: float</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lenstronomy.ImSim.de_lens.marginalization_new">
<span class="sig-prename descclassname"><span class="pre">lenstronomy.ImSim.de_lens.</span></span><span class="sig-name descname"><span class="pre">marginalization_new</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M_inv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/de_lens.html#marginalization_new"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.de_lens.marginalization_new" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M_inv</strong> – 2D covariance matrix</p></li>
<li><p><strong>d_prior</strong> – maximum prior length of linear parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>log determinant with eigenvalues to be smaller or equal d_prior</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-lenstronomy.ImSim.image2source_mapping">
<span id="lenstronomy-imsim-image2source-mapping-module"></span><h2>lenstronomy.ImSim.image2source_mapping module<a class="headerlink" href="#module-lenstronomy.ImSim.image2source_mapping" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image2source_mapping.Image2SourceMapping">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lenstronomy.ImSim.image2source_mapping.</span></span><span class="sig-name descname"><span class="pre">Image2SourceMapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lensModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sourceModel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image2source_mapping.html#Image2SourceMapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image2source_mapping.Image2SourceMapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>this class handles multiple source planes and performs the computation of predicted surface brightness at given
image positions.
The class is enable to deal with an arbitrary number of different source planes. There are two different settings:</p>
<p>Single lens plane modelling:
In case of a single deflector, lenstronomy models the reduced deflection angles
(matched to the source plane in single source plane mode). Each source light model can be added a number
(scale_factor) that rescales the reduced deflection angle to the specific source plane.</p>
<p>Multiple lens plane modelling:
The multi-plane lens modelling requires the assumption of a cosmology and the redshifts of the multiple lens and
source planes. The backwards ray-tracing is performed and stopped at the different source plane redshift to compute
the mapping between source to image plane.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image2source_mapping.Image2SourceMapping.image2source">
<span class="sig-name descname"><span class="pre">image2source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_source</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image2source_mapping.html#Image2SourceMapping.image2source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image2source_mapping.Image2SourceMapping.image2source" title="Permalink to this definition">¶</a></dt>
<dd><p>mapping of image plane to source plane coordinates
WARNING: for multi lens plane computations and multi source planes, this computation can be slow and should be
used as rarely as possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – image plane coordinate (angle)</p></li>
<li><p><strong>y</strong> – image plane coordinate (angle)</p></li>
<li><p><strong>kwargs_lens</strong> – lens model kwargs list</p></li>
<li><p><strong>index_source</strong> – int, index of source model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>source plane coordinate corresponding to the source model of index idex_source</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image2source_mapping.Image2SourceMapping.image_flux_joint">
<span class="sig-name descname"><span class="pre">image_flux_joint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image2source_mapping.html#Image2SourceMapping.image_flux_joint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image2source_mapping.Image2SourceMapping.image_flux_joint" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – coordinate in image plane</p></li>
<li><p><strong>y</strong> – coordinate in image plane</p></li>
<li><p><strong>kwargs_lens</strong> – lens model kwargs list</p></li>
<li><p><strong>kwargs_source</strong> – source model kwargs list</p></li>
<li><p><strong>k</strong> – None or int or list of int for partial evaluation of light models</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>surface brightness of all joint light components at image position (x, y)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image2source_mapping.Image2SourceMapping.image_flux_split">
<span class="sig-name descname"><span class="pre">image_flux_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_source</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image2source_mapping.html#Image2SourceMapping.image_flux_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image2source_mapping.Image2SourceMapping.image_flux_split" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – coordinate in image plane</p></li>
<li><p><strong>y</strong> – coordinate in image plane</p></li>
<li><p><strong>kwargs_lens</strong> – lens model kwargs list</p></li>
<li><p><strong>kwargs_source</strong> – source model kwargs list</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of responses of every single basis component with default amplitude amp=1, in the same order as the light_model_list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-lenstronomy.ImSim.image_linear_solve">
<span id="lenstronomy-imsim-image-linear-solve-module"></span><h2>lenstronomy.ImSim.image_linear_solve module<a class="headerlink" href="#module-lenstronomy.ImSim.image_linear_solve" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lenstronomy.ImSim.image_linear_solve.</span></span><span class="sig-name descname"><span class="pre">ImageLinearFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lens_model_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_model_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lens_light_model_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_source_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extinction_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_numerics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_error_map_bool_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_pixelbased</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lenstronomy.ImSim.image_model.ImageModel" title="lenstronomy.ImSim.image_model.ImageModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">lenstronomy.ImSim.image_model.ImageModel</span></code></a></p>
<p>linear version class, inherits ImageModel.</p>
<p>When light models use pixel-based profile types, such as ‘SLIT_STARLETS’, 
the WLS linear inversion is replaced by the regularized inversion performed by an external solver.
The current pixel-based solver is provided by the SLITronomy plug-in.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.array_masked2image">
<span class="sig-name descname"><span class="pre">array_masked2image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.array_masked2image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.array_masked2image" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>array</strong> – 1d array of values not masked out (part of linear fitting)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2d array of full image</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.check_positive_flux">
<span class="sig-name descname"><span class="pre">check_positive_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens_light</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_ps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.check_positive_flux"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.check_positive_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>checks whether the surface brightness profiles contain positive fluxes and returns bool if True</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_source</strong> – source surface brightness keyword argument list</p></li>
<li><p><strong>kwargs_lens_light</strong> – lens surface brightness keyword argument list</p></li>
<li><p><strong>kwargs_ps</strong> – point source keyword argument list</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.data_response">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_response</span></span><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.data_response" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the 1d array of the data element that is fitted for (including masking)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>1d numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.error_map_source">
<span class="sig-name descname"><span class="pre">error_map_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_param</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.error_map_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.error_map_source" title="Permalink to this definition">¶</a></dt>
<dd><p>variance of the linear source reconstruction in the source plane coordinates,
computed by the diagonal elements of the covariance matrix of the source reconstruction as a sum of the errors
of the basis set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_source</strong> – keyword arguments of source model</p></li>
<li><p><strong>x_grid</strong> – x-axis of positions to compute error map</p></li>
<li><p><strong>y_grid</strong> – y-axis of positions to compute error map</p></li>
<li><p><strong>cov_param</strong> – covariance matrix of liner inversion parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>diagonal covariance errors at the positions (x_grid, y_grid)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.error_response">
<span class="sig-name descname"><span class="pre">error_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_lens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_special</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.error_response"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.error_response" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the 1d array of the error estimate corresponding to the data response</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>1d numpy array of response, 2d array of additonal errors (e.g. point source uncertainties)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.image2array_masked">
<span class="sig-name descname"><span class="pre">image2array_masked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.image2array_masked"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.image2array_masked" title="Permalink to this definition">¶</a></dt>
<dd><p>returns 1d array of values in image that are not masked out for the likelihood computation/linear minimization
:param image: 2d numpy array of full image
:return: 1d array</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.image_linear_solve">
<span class="sig-name descname"><span class="pre">image_linear_solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_lens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens_light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_ps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_extinction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_special</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_bool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.image_linear_solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.image_linear_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>computes the image (lens and source surface brightness with a given lens model).
The linear parameters are computed with a weighted linear least square optimization (i.e. flux normalization of the brightness profiles)
However in case of pixel-based modelling, pixel values are constrained by an external solver (e.g. SLITronomy).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_lens</strong> – list of keyword arguments corresponding to the superposition of different lens profiles</p></li>
<li><p><strong>kwargs_source</strong> – list of keyword arguments corresponding to the superposition of different source light profiles</p></li>
<li><p><strong>kwargs_lens_light</strong> – list of keyword arguments corresponding to different lens light surface brightness profiles</p></li>
<li><p><strong>kwargs_ps</strong> – keyword arguments corresponding to “other” parameters, such as external shear and point source image positions</p></li>
<li><p><strong>inv_bool</strong> – if True, invert the full linear solver Matrix Ax = y for the purpose of the covariance matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2d array of surface brightness pixels of the optimal solution of the linear parameters to match the data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.image_pixelbased_solve">
<span class="sig-name descname"><span class="pre">image_pixelbased_solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_lens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens_light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_ps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_extinction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_special</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_lens_light_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.image_pixelbased_solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.image_pixelbased_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>computes the image (lens and source surface brightness with a given lens model) using the pixel-based solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_lens</strong> – list of keyword arguments corresponding to the superposition of different lens profiles</p></li>
<li><p><strong>kwargs_source</strong> – list of keyword arguments corresponding to the superposition of different source light profiles</p></li>
<li><p><strong>kwargs_lens_light</strong> – list of keyword arguments corresponding to different lens light surface brightness profiles</p></li>
<li><p><strong>kwargs_ps</strong> – keyword arguments corresponding to point sources</p></li>
<li><p><strong>kwargs_extinction</strong> – keyword arguments corresponding to dust extinction</p></li>
<li><p><strong>kwargs_special</strong> – keyword arguments corresponding to “special” parameters</p></li>
<li><p><strong>init_lens_light_model</strong> – optional initial guess for the lens surface brightness</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2d array of surface brightness pixels of the optimal solution of the linear parameters to match the data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.likelihood_data_given_model">
<span class="sig-name descname"><span class="pre">likelihood_data_given_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_lens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens_light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_ps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_extinction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_special</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_marg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_positive_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.likelihood_data_given_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.likelihood_data_given_model" title="Permalink to this definition">¶</a></dt>
<dd><p>computes the likelihood of the data given a model
This is specified with the non-linear parameters and a linear inversion and prior marginalisation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_lens</strong> – list of keyword arguments corresponding to the superposition of different lens profiles</p></li>
<li><p><strong>kwargs_source</strong> – list of keyword arguments corresponding to the superposition of different source light profiles</p></li>
<li><p><strong>kwargs_lens_light</strong> – list of keyword arguments corresponding to different lens light surface brightness profiles</p></li>
<li><p><strong>kwargs_ps</strong> – keyword arguments corresponding to “other” parameters, such as external shear and point source image positions</p></li>
<li><p><strong>kwargs_extinction</strong> – </p></li>
<li><p><strong>kwargs_special</strong> – </p></li>
<li><p><strong>source_marg</strong> – bool, performs a marginalization over the linear parameters</p></li>
<li><p><strong>linear_prior</strong> – linear prior width in eigenvalues</p></li>
<li><p><strong>check_positive_flux</strong> – bool, if True, checks whether the linear inversion resulted in non-negative flux
components and applies a punishment in the likelihood if so.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>log likelihood (natural logarithm)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.linear_response_matrix">
<span class="sig-name descname"><span class="pre">linear_response_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_lens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens_light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_ps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_extinction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_special</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.linear_response_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.linear_response_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>computes the linear response matrix (m x n), with n being the data size and m being the coefficients</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_lens</strong> – lens model keyword argument list</p></li>
<li><p><strong>kwargs_source</strong> – extended source model keyword argument list</p></li>
<li><p><strong>kwargs_lens_light</strong> – lens light model keyword argument list</p></li>
<li><p><strong>kwargs_ps</strong> – point source model keyword argument list</p></li>
<li><p><strong>kwargs_extinction</strong> – extinction model keyword argument list</p></li>
<li><p><strong>kwargs_special</strong> – special keyword argument list</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>linear response matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.num_data_evaluate">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_data_evaluate</span></span><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.num_data_evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>number of data points to be used in the linear solver
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.num_param_linear">
<span class="sig-name descname"><span class="pre">num_param_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_lens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens_light</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_ps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.num_param_linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.num_param_linear" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of linear coefficients to be solved for in the linear inversion</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.point_source_linear_response_set">
<span class="sig-name descname"><span class="pre">point_source_linear_response_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_special</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_amp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.point_source_linear_response_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.point_source_linear_response_set" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_ps</strong> – point source keyword argument list</p></li>
<li><p><strong>kwargs_lens</strong> – lens model keyword argument list</p></li>
<li><p><strong>kwargs_special</strong> – special keyword argument list, may include ‘delta_x_image’ and ‘delta_y_image’</p></li>
<li><p><strong>with_amp</strong> – bool, if True, relative magnification between multiply imaged point sources are held fixed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of positions and amplitudes split in different basis components with applied astrometric corrections</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.reduced_chi2">
<span class="sig-name descname"><span class="pre">reduced_chi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.reduced_chi2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.reduced_chi2" title="Permalink to this definition">¶</a></dt>
<dd><p>returns reduced chi2
:param model: 2d numpy array of a model predicted image
:param error_map: same format as model, additional error component (such as PSF errors)
:return: reduced chi2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.reduced_residuals">
<span class="sig-name descname"><span class="pre">reduced_residuals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.reduced_residuals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.reduced_residuals" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – 2d numpy array of the modeled image</p></li>
<li><p><strong>error_map</strong> – 2d numpy array of additional noise/error terms from model components (such as PSF model uncertainties)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2d numpy array of reduced residuals per pixel</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.update_data">
<span class="sig-name descname"><span class="pre">update_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_class</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.update_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.update_data" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_class</strong> – instance of Data() class</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>no return. Class is updated.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.update_linear_kwargs">
<span class="sig-name descname"><span class="pre">update_linear_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens_light</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_ps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.update_linear_kwargs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.update_linear_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>links linear parameters to kwargs arguments</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>param</strong> – linear parameter vector corresponding to the response matrix</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>updated list of kwargs with linear parameter values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_linear_solve.ImageLinearFit.update_pixel_kwargs">
<span class="sig-name descname"><span class="pre">update_pixel_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens_light</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_linear_solve.html#ImageLinearFit.update_pixel_kwargs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_linear_solve.ImageLinearFit.update_pixel_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Update kwargs arguments for pixel-based profiles with fixed properties
such as their number of pixels, scale, and center coordinates (fixed to the origin).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_source</strong> – list of keyword arguments corresponding to the superposition of different source light profiles</p></li>
<li><p><strong>kwargs_lens_light</strong> – list of keyword arguments corresponding to the superposition of different lens light profiles</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>updated kwargs_source and kwargs_lens_light</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-lenstronomy.ImSim.image_model">
<span id="lenstronomy-imsim-image-model-module"></span><h2>lenstronomy.ImSim.image_model module<a class="headerlink" href="#module-lenstronomy.ImSim.image_model" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_model.ImageModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lenstronomy.ImSim.image_model.</span></span><span class="sig-name descname"><span class="pre">ImageModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lens_model_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_model_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lens_light_model_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_source_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extinction_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_numerics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_pixelbased</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_model.html#ImageModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_model.ImageModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>this class uses functions of lens_model and source_model to make a lensed image</p>
<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_model.ImageModel.extinction_map">
<span class="sig-name descname"><span class="pre">extinction_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_extinction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_special</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_model.html#ImageModel.extinction_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_model.ImageModel.extinction_map" title="Permalink to this definition">¶</a></dt>
<dd><p>differential extinction per pixel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_extinction</strong> – list of keyword arguments corresponding to the optical depth models tau, such that extinction is exp(-tau)</p></li>
<li><p><strong>kwargs_special</strong> – keyword arguments, additional parameter to the extinction</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2d array of size of the image</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_model.ImageModel.image">
<span class="sig-name descname"><span class="pre">image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_lens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens_light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_ps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_extinction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_special</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unconvolved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lens_light_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_source_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_model.html#ImageModel.image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_model.ImageModel.image" title="Permalink to this definition">¶</a></dt>
<dd><p>make an image with a realisation of linear parameter values “param”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_lens</strong> – list of keyword arguments corresponding to the superposition of different lens profiles</p></li>
<li><p><strong>kwargs_source</strong> – list of keyword arguments corresponding to the superposition of different source light profiles</p></li>
<li><p><strong>kwargs_lens_light</strong> – list of keyword arguments corresponding to different lens light surface brightness profiles</p></li>
<li><p><strong>kwargs_ps</strong> – keyword arguments corresponding to “other” parameters, such as external shear and point source image positions</p></li>
<li><p><strong>unconvolved</strong> – if True: returns the unconvolved light distribution (prefect seeing)</p></li>
<li><p><strong>source_add</strong> – if True, compute source, otherwise without</p></li>
<li><p><strong>lens_light_add</strong> – if True, compute lens light, otherwise without</p></li>
<li><p><strong>point_source_add</strong> – if True, add point sources, otherwise without</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2d array of surface brightness pixels of the simulation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_model.ImageModel.lens_surface_brightness">
<span class="sig-name descname"><span class="pre">lens_surface_brightness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_lens_light</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unconvolved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_model.html#ImageModel.lens_surface_brightness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_model.ImageModel.lens_surface_brightness" title="Permalink to this definition">¶</a></dt>
<dd><p>computes the lens surface brightness distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_lens_light</strong> – list of keyword arguments corresponding to different lens light surface brightness profiles</p></li>
<li><p><strong>unconvolved</strong> – if True, returns unconvolved surface brightness (perfect seeing), otherwise convolved with PSF kernel</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2d array of surface brightness pixels</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_model.ImageModel.point_source">
<span class="sig-name descname"><span class="pre">point_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_special</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unconvolved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_model.html#ImageModel.point_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_model.ImageModel.point_source" title="Permalink to this definition">¶</a></dt>
<dd><p>computes the point source positions and paints PSF convolutions on them</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_ps</strong> – </p></li>
<li><p><strong>k</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_model.ImageModel.reset_point_source_cache">
<span class="sig-name descname"><span class="pre">reset_point_source_cache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_model.html#ImageModel.reset_point_source_cache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_model.ImageModel.reset_point_source_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>deletes all the cache in the point source class and saves it from then on</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cache</strong> – boolean, if True, saves the next occuring point source positions in the cache</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_model.ImageModel.source_surface_brightness">
<span class="sig-name descname"><span class="pre">source_surface_brightness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_lens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_extinction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_special</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unconvolved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">de_lensed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_pixelbased_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_model.html#ImageModel.source_surface_brightness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_model.ImageModel.source_surface_brightness" title="Permalink to this definition">¶</a></dt>
<dd><p>computes the source surface brightness distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_source</strong> – list of keyword arguments corresponding to the superposition of different source light profiles</p></li>
<li><p><strong>kwargs_lens</strong> – list of keyword arguments corresponding to the superposition of different lens profiles</p></li>
<li><p><strong>kwargs_extinction</strong> – list of keyword arguments of extinction model</p></li>
<li><p><strong>unconvolved</strong> – if True: returns the unconvolved light distribution (prefect seeing)</p></li>
<li><p><strong>de_lensed</strong> – if True: returns the un-lensed source surface brightness profile, otherwise the lensed.</p></li>
<li><p><strong>k</strong> – integer, if set, will only return the model of the specific index</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2d array of surface brightness pixels</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenstronomy.ImSim.image_model.ImageModel.update_psf">
<span class="sig-name descname"><span class="pre">update_psf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psf_class</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/ImSim/image_model.html#ImageModel.update_psf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lenstronomy.ImSim.image_model.ImageModel.update_psf" title="Permalink to this definition">¶</a></dt>
<dd><p>update the instance of the class with a new instance of PSF() with a potentially different point spread function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>psf_class</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>no return. Class is updated.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-lenstronomy.ImSim">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-lenstronomy.ImSim" title="Permalink to this headline">¶</a></h2>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">lenstronomy.ImSim package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-lenstronomy.ImSim.de_lens">lenstronomy.ImSim.de_lens module</a></li>
<li><a class="reference internal" href="#module-lenstronomy.ImSim.image2source_mapping">lenstronomy.ImSim.image2source_mapping module</a></li>
<li><a class="reference internal" href="#module-lenstronomy.ImSim.image_linear_solve">lenstronomy.ImSim.image_linear_solve module</a></li>
<li><a class="reference internal" href="#module-lenstronomy.ImSim.image_model">lenstronomy.ImSim.image_model module</a></li>
<li><a class="reference internal" href="#module-lenstronomy.ImSim">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="lenstronomy.GalKin.html"
                        title="previous chapter">lenstronomy.GalKin package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="lenstronomy.ImSim.MultiBand.html"
                        title="next chapter">lenstronomy.ImSim.MultiBand package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/lenstronomy.ImSim.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="lenstronomy.ImSim.MultiBand.html" title="lenstronomy.ImSim.MultiBand package"
             >next</a> |</li>
        <li class="right" >
          <a href="lenstronomy.GalKin.html" title="lenstronomy.GalKin package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">lenstronomy 1.10.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="lenstronomy.html" >lenstronomy package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">lenstronomy.ImSim package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Simon Birrer and contributors.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.1.
    </div>
  </body>
</html>