window.dash_luckysheet=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var n,o=function(){var e=document.currentScript;if(!e){for(var t=document.getElementsByTagName("script"),r=[],n=0;n<t.length;n++)r.push(t[n]);e=(r=r.filter((function(e){return!e.async&&!e.text&&!e.textContent}))).slice(-1)[0]}return e};if(Object.defineProperty(r,"p",{get:(n=o().src.split("/").slice(0,-1).join("/")+"/",function(){return n})}),"undefined"!=typeof jsonpScriptSrc){var i=jsonpScriptSrc;jsonpScriptSrc=function(e){var t=function(e){return/\/_dash-component-suites\//.test(e.src)}(o()),r=i(e);if(!t)return r;var n=r.split("/"),a=n.slice(-1)[0].split(".");return a.splice(1,0,"v0_0_1m1650544486"),n.splice(-1,1,a.join(".")),n.join("/")}}return r(r.s=3)}([function(e,t){e.exports=window.React},function(e,t){e.exports=window.PropTypes},,function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),i=r(1),a=r.n(i);function l(e){return null!=e&&"object"==typeof e&&!0===e["@@functional/placeholder"]}function c(e){return function t(r){return 0===arguments.length||l(r)?t:e.apply(this,arguments)}}function u(e){return function t(r,n){switch(arguments.length){case 0:return t;case 1:return l(r)?t:c((function(t){return e(r,t)}));default:return l(r)&&l(n)?t:l(r)?c((function(t){return e(t,n)})):l(n)?c((function(t){return e(r,t)})):e(r,n)}}}var s=Array.isArray||function(e){return null!=e&&e.length>=0&&"[object Array]"===Object.prototype.toString.call(e)};function f(e){return null!=e&&"function"==typeof e["@@transducer/step"]}function p(e,t,r){return function(){if(0===arguments.length)return r();var n=Array.prototype.slice.call(arguments,0),o=n.pop();if(!s(o)){for(var i=0;i<e.length;){if("function"==typeof o[e[i]])return o[e[i]].apply(o,n);i+=1}if(f(o)){var a=t.apply(null,n);return a(o)}}return r.apply(this,arguments)}}var d=function(){return this.xf["@@transducer/init"]()},h=function(){function e(e,t){this.xf=t,this.f=e,this.all=!0}return e.prototype["@@transducer/init"]=d,e.prototype["@@transducer/result"]=function(e){return this.all&&(e=this.xf["@@transducer/step"](e,!0)),this.xf["@@transducer/result"](e)},e.prototype["@@transducer/step"]=function(e,t){var r;return this.f(t)||(this.all=!1,e=(r=this.xf["@@transducer/step"](e,!1))&&r["@@transducer/reduced"]?r:{"@@transducer/value":r,"@@transducer/reduced":!0}),e},e}(),y=u(p(["all"],u((function(e,t){return new h(e,t)})),(function(e,t){for(var r=0;r<t.length;){if(!e(t[r]))return!1;r+=1}return!0}))),b=u((function(e,t){return y((r=e,function(){return!r.apply(this,arguments)}),t);var r}));function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){x(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function x(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,o,i=[],a=!0,l=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){l=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(l)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=E(e);if(t){var o=E(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return k(this,r)}}function k(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(a,e);var t,r,n,i=S(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={data:e.data,xlsx:e.xlsx,initialized:!1},t.timeout=b,t}return t=a,(r=[{key:"componentDidMount",value:function(){this.props.data?this.create_luckysheet(this.props.data):this.props.xlsx?this.load_remote_excel(this.props.xlsx):this.create_luckysheet(void 0)}},{key:"load_remote_excel",value:function(e){var t=this,r=new XMLHttpRequest;r.responseType="blob",r.open("GET",e,!0),r.onload=function(e){if(4===r.readyState)if(200===r.status){var n=new Blob([r.response],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});window.LuckyExcel.transformExcelToLucky(n,(function(e,r){t.create_luckysheet(e.sheets)}))}else console.error(r.statusText)},r.onerror=function(e){console.error(r.statusText)},r.send(null)}},{key:"destroy_luckysheet",value:function(){window.luckysheet.destroy({container:this.props.id+"-container"})}},{key:"create_luckysheet",value:function(e){var t=window.luckysheet,r=this;t.create({container:this.props.id+"-container",plugins:[],title:"",userInfo:!1,data:e,showtoolbarConfig:{protection:!1,print:!1,chart:!1,paintFormat:!1,image:!1,link:!1,moreFormats:!1,dataVerification:!1,splitColumn:!1,screenshot:!1,conditionalFormat:!1},defaultFontSize:12,hook:{cellRenderAfter:function(e,n,o,i){r.state.initialized&&(r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout((function(){var e=t.toJson();r.setState({data:e.data},(function(){r.props.setProps({data:e.data})}))}),1e3))}}}),setTimeout((function(){r.setState({initialized:!0})}),1e3)}},{key:"update_luckysheet",value:function(e){var t=this;this.setState({initialized:!1},(function(){t.destroy_luckysheet(),t.create_luckysheet(e)}))}},{key:"update_luckysheet_excel",value:function(e){var t=this;this.setState({initialized:!1},(function(){t.destroy_luckysheet(),t.load_remote_excel(e)}))}},{key:"download_excel",value:function(){var e=this,t=new ExcelJS.Workbook;window.luckysheet.toJson().data.forEach((function(r){var n=t.addWorksheet(r.name);e.setStyleAndValue(r.data,r.config,n),"filter_select"in r&&(n.autoFilter={from:{row:r.filter_select.row[0]+1,column:r.filter_select.column[0]+1},to:{row:r.filter_select.row[1]+1,column:r.filter_select.column[1]+1}})})),t.xlsx.writeBuffer().then((function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});saveAs(t,"data.xlsx")}))}},{key:"setStyleAndValue",value:function(e,t,r){var n={vt:{0:"middle",1:"top",2:"bottom",default:"top"},ht:{0:"center",1:"left",2:"right",default:"left"},wrap:{0:!1,1:!1,2:!0,default:!1},rot:{0:0,1:45,2:-45,3:"vertical",4:90,5:-90,default:0},borderStyle:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}};if(e.forEach((function(e,t){e.every((function(e,o){if(!e)return!0;e.constructor!=Object&&(e={v:e});var i=r.getCell(t+1,o+1);return i.fill=e.bg?{type:"pattern",pattern:"solid",fgColor:{argb:e.bg.replace("#","")}}:{},i.font={size:e.fs,color:e.fc?{argb:e.fc.replace("#","")}:{},bold:e.bl,italic:e.it,underline:e.un,strike:e.cl},i.alignment={vertical:e.vt?n.vt[e.vt]:n.vt.default,horizontal:e.ht?n.ht[e.ht]:n.ht.default,wrapText:e.tb?n.wrap[e.tb]:n.wrap.default,textRotation:e.tr?n.rot[e.tr]:n.rot.default},"ps"in e&&"value"in e.ps&&(i.note=e.ps.value),i.value=e.f?{formula:e.f,result:e.v}:e.v,!0}))})),"rowlen"in t)for(var o=0,i=Object.entries(t.rowlen);o<i.length;o++){var a=w(i[o],2),l=a[0],c=a[1];r.getRow(parseInt(l)+1).height=.75*c}if("columnlen"in t)for(var u=0,s=Object.entries(t.columnlen);u<s.length;u++){var f=w(s[u],2),p=f[0],d=f[1];r.getColumn(parseInt(p)+1).width=.125*d}if("rowhidden"in t)for(var h=0,y=Object.entries(t.rowhidden);h<y.length;h++){var b=w(y[h],2),m=b[0],v=b[1];r.getRow(parseInt(m)+1).hidden=0==v}if("colhidden"in t)for(var x=0,_=Object.entries(t.colhidden);x<_.length;x++){var O=w(_[x],2),j=O[0],S=O[1];r.getColumn(parseInt(j)+1).hidden=0==S}if("borderInfo"in t&&t.borderInfo.forEach((function(e){var t={style:e.style?n.borderStyle[e.style]:n.borderStyle[1],color:e.color?{argb:e.color.replace("#","")}:{argb:"000"}},o={};"border-all"!=e.borderType&&"border-top"!=e.borderType||(o.top=t),"border-all"!=e.borderType&&"border-bottom"!=e.borderType||(o.bottom=t),"border-all"!=e.borderType&&"border-right"!=e.borderType||(o.right=t),"border-all"!=e.borderType&&"border-left"!=e.borderType||(o.left=t),"range"in e&&e.range.forEach((function(e){for(var t=e.column[0]+1;t<=e.column[1]+1;t++)for(var n=e.row[0]+1;n<=e.row[1]+1;n++)r.getCell(n,t).border=g(g({},r.getCell(n,t).border),o)}))})),"merge"in t)for(var k=0,E=Object.entries(t.merge);k<E.length;k++){var C=w(E[k],2),P=(C[0],C[1]);r.mergeCells(P.r+1,P.c+1,P.r+P.rs,P.c+P.cs)}}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;e.data&&e.data!==this.state.data&&this.state.initialized&&this.setState({data:e.data},(function(){t.update_luckysheet(e.data)})),e.xlsx&&e.xlsx!==this.state.xlsx&&this.state.initialized&&this.setState({xlsx:e.xlsx},(function(){t.update_luckysheet_excel(e.xlsx)}))}},{key:"render",value:function(){var e=this,t=this.props.id;return o.a.createElement("div",{id:t,style:this.props.style},o.a.createElement("div",{id:t+"-container",style:{margin:"0px",padding:"0px",position:"relative",width:"100%",height:"100%",left:"0px",top:"0px"}}),o.a.createElement("a",{style:{position:"relative",bottom:"53px",left:"15px",cursor:"pointer",zIndex:301},type:"button",onClick:function(t){t.stopPropagation(),e.download_excel()},key:this.props.id+"-excel-button"},o.a.createElement("svg",{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 2289.75 2130",enableBackground:"new 0 0 2289.75 2130",width:"28px",height:"29px",className:"excel-icon"},o.a.createElement("metadata",null,o.a.createElement("sfw",{xmlns:"http://ns.adobe.com/SaveForWeb/1.0/"},o.a.createElement("slices",null),o.a.createElement("sliceSourceBounds",{height:"2130",width:"2289.75",x:"-1147.5",y:"-1041"}))),o.a.createElement("path",{fill:"#185C37",d:"M1437.75,1011.75L532.5,852v1180.393c0,53.907,43.7,97.607,97.607,97.607l0,0h1562.036  c53.907,0,97.607-43.7,97.607-97.607l0,0V1597.5L1437.75,1011.75z"}),o.a.createElement("path",{fill:"#21A366",d:"M1437.75,0H630.107C576.2,0,532.5,43.7,532.5,97.607c0,0,0,0,0,0V532.5l905.25,532.5L1917,1224.75  L2289.75,1065V532.5L1437.75,0z"}),o.a.createElement("path",{fill:"#107C41",d:"M532.5,532.5h905.25V1065H532.5V532.5z"}),o.a.createElement("path",{opacity:"0.1",d:"M1180.393,426H532.5v1331.25h647.893c53.834-0.175,97.432-43.773,97.607-97.607  V523.607C1277.825,469.773,1234.227,426.175,1180.393,426z"}),o.a.createElement("path",{opacity:"0.2",d:"M1127.143,479.25H532.5V1810.5h594.643  c53.834-0.175,97.432-43.773,97.607-97.607V576.857C1224.575,523.023,1180.977,479.425,1127.143,479.25z"}),o.a.createElement("path",{opacity:"0.2",d:"M1127.143,479.25H532.5V1704h594.643c53.834-0.175,97.432-43.773,97.607-97.607  V576.857C1224.575,523.023,1180.977,479.425,1127.143,479.25z"}),o.a.createElement("path",{opacity:"0.2",d:"M1073.893,479.25H532.5V1704h541.393c53.834-0.175,97.432-43.773,97.607-97.607  V576.857C1171.325,523.023,1127.727,479.425,1073.893,479.25z"}),o.a.createElement("linearGradient",{id:"SVGID_1_",gradientUnits:"userSpaceOnUse",x1:"203.5132",y1:"1729.0183",x2:"967.9868",y2:"404.9817",gradientTransform:"matrix(1 0 0 -1 0 2132)"},o.a.createElement("stop",{offset:"0",style:{stopColor:"#18884F"}}),o.a.createElement("stop",{offset:"0.5",style:{stopColor:"#117E43"}}),o.a.createElement("stop",{offset:"1",style:{stopColor:"#0B6631"}})),o.a.createElement("path",{fill:"url(#SVGID_1_)",d:"M97.607,479.25h976.285c53.907,0,97.607,43.7,97.607,97.607v976.285  c0,53.907-43.7,97.607-97.607,97.607H97.607C43.7,1650.75,0,1607.05,0,1553.143V576.857C0,522.95,43.7,479.25,97.607,479.25z"}),o.a.createElement("path",{fill:"#FFFFFF",d:"M302.3,1382.264l205.332-318.169L319.5,747.683h151.336l102.666,202.35  c9.479,19.223,15.975,33.494,19.49,42.919h1.331c6.745-15.336,13.845-30.228,21.3-44.677L725.371,747.79h138.929l-192.925,314.548  L869.2,1382.263H721.378L602.79,1160.158c-5.586-9.45-10.326-19.376-14.164-29.66h-1.757c-3.474,10.075-8.083,19.722-13.739,28.755  l-122.102,223.011H302.3z"}),o.a.createElement("path",{fill:"#33C481",d:"M2192.143,0H1437.75v532.5h852V97.607C2289.75,43.7,2246.05,0,2192.143,0L2192.143,0z"}),o.a.createElement("path",{fill:"#107C41",d:"M1437.75,1065h852v532.5h-852V1065z"}))))}}])&&O(t.prototype,r),n&&O(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(n.Component);C.defaultProps={},C.propTypes={id:a.a.string.isRequired,data:a.a.any,xlsx:a.a.any,style:a.a.any,setProps:a.a.func},r.d(t,"Luckysheet",(function(){return C}))}]);
//# sourceMappingURL=dash_luckysheet.min.js.map
//# sourceMappingURL=dash_luckysheet.min.js.map